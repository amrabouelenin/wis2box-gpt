---
title: Запрос данных с использованием API wis2box
---

# Запрос данных с использованием API wis2box

!!! abstract "Учебные результаты"
    К концу этого практического занятия вы сможете:

    - использовать API wis2box для запроса и фильтрации ваших станций
    - использовать API wis2box для запроса и фильтрации ваших данных

## Введение

API wis2box предоставляет доступ к обнаружению и запросу данных в машиночитаемом формате, которые были загружены в wis2box. API основан на стандарте OGC API - Features и реализован с использованием [pygeoapi](https://pygeoapi.io).

API wis2box предоставляет доступ к следующим коллекциям:

- Станции
- Метаданные обнаружения
- Уведомления о данных
- плюс одна коллекция на каждый настроенный набор данных, которая хранит результаты работы bufr2geojson (плагин `bufr2geojson` должен быть включен в конфигурации сопоставления данных для заполнения элементов в коллекции набора данных).

На этом практическом занятии вы научитесь использовать API данных для просмотра и запроса данных, загруженных в wis2box.

## Подготовка

!!! note
    Перейдите на главную страницу API wis2box в вашем веб-браузере:

    `http://<your-host>/oapi`

<img alt="wis2box-api-landing-page" src="../../assets/img/wis2box-api-landing-page.png" width="600">

## Изучение коллекций

На главной странице нажмите на ссылку "Коллекции".

!!! question
    Сколько коллекций наборов данных вы видите на полученной странице? Что, по вашему мнению, представляет каждая коллекция?

??? success "Нажмите, чтобы увидеть ответ"
    Должно быть отображено 4 коллекции, включая "Станции", "Метаданные обнаружения" и "Уведомления о данных"

## Изучение станций

На главной странице нажмите на ссылку "Коллекции", затем нажмите на ссылку "Станции".

<img alt="wis2box-api-collections-stations" src="../../assets/img/wis2box-api-collections-stations.png" width="600">

Нажмите на ссылку "Обзор", затем нажмите на ссылку "json".

!!! question
    Сколько станций возвращено? Сравните это число со списком станций в `http://<your-host>/wis2box-webapp/station`

??? success "Нажмите, чтобы увидеть ответ"
    Количество станций из API должно быть равно количеству станций, которые вы видите в веб-приложении wis2box.

!!! question
    Как можно запросить одну станцию (например, `Balaka`)?

??? success "Нажмите, чтобы увидеть ответ"
    Запросите API с `http://<your-host>/oapi/collections/stations/items?q=Balaka`.

!!! note
    Приведенный выше пример основан на тестовых данных Малави. Попробуйте тестировать на станциях, которые вы загрузили в рамках предыдущих упражнений.

## Изучение наблюдений

!!! note
    Приведенный выше пример основан на тестовых данных Малави. Попробуйте тестировать на наблюдениях, которые вы загрузили в рамках упражнений.

На главной странице нажмите на ссылку "Коллекции", затем нажмите на ссылку "Наблюдения за погодой на поверхности из Малави".

<img alt="wis2box-api-collections-malawi-obs" src="../../assets/img/wis2box-api-collections-malawi-obs.png" width="600">

Нажмите на ссылку "Запрашиваемые параметры".

<img alt="wis2box-api-collections-malawi-obs-queryables" src="../../assets/img/wis2box-api-collections-malawi-obs-queryables.png" width="600">

!!! question
    Какой параметр можно использовать для фильтрации по идентификатору станции?

??? success "Нажмите, чтобы увидеть ответ"
    Правильный параметр - `wigos_station_identifer`.

Перейдите на предыдущую страницу (т.е. `http://<your-host>/oapi/collections/urn:wmo:md:mwi:mwi_met_centre:surface-weather-observations`)

Нажмите на ссылку "Обзор".

!!! question
    Как можно визуализировать ответ JSON?

??? success "Нажмите, чтобы увидеть ответ"
    Нажав на ссылку 'JSON' в верхней правой части страницы или добавив `f=json` к запросу API в веб-браузере.

Изучите ответ JSON наблюдений.

!!! question
    Сколько записей возвращено?

!!! question
    Как можно ограничить ответ тремя наблюдениями?

??? success "Нажмите, чтобы увидеть ответ"
    Добавьте `limit=3` к запросу API.

!!! question
    Как можно сортировать ответ по последним наблюдениям?

??? success "Нажмите, чтобы увидеть ответ"
    Добавьте `sortby=-resultTime` к запросу API (обратите внимание на знак `-`, обозначающий порядок сортировки по убыванию). Для сортировки по самым ранним наблюдениям обновите запрос, включив `sortby=resultTime`.

!!! question
    Как можно отфильтровать наблюдения по одной станции?

??? success "Нажмите, чтобы увидеть ответ"
    Добавьте `wigos_station_identifier=<WSI>` к запросу API.

!!! question
    Как можно получить наблюдения в формате CSV?

??? success "Нажмите, чтобы увидеть ответ"
    Добавьте `f=csv` к запросу API.

!!! question
    Как можно показать одно наблюдение (id)?

??? success "Нажмите, чтобы увидеть ответ"
    Используя идентификатор функции из запроса API против наблюдений, запросите API для `http://<your-host>/oapi/collections/{collectionId}/items/{featureId}`, где `{collectionId}` - это имя вашей коллекции наблюдений, а `{itemId}` - идентификатор интересующего вас одного наблюдения.

## Заключение

!!! success "Поздравляем!"
    На этом практическом занятии вы научились:

    - использовать API wis2box для запроса и фильтрации ваших станций
    - использовать API wis2box для запроса и фильтрации ваших данных