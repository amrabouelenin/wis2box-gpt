
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://amrabouelenin.github.io/wis2docs/print_page/">
      
      
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Print Site - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
    <script>__md_scope=new URL("/wis2docs/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zh" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../zh/" title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../practical-sessions/querying-data-using-the-wis2box-api/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../ru/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="ru" class="md-select__link">
              Русский
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../es/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../pt/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="pt" class="md-select__link">
              Português
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../fr/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../ar/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="ar" class="md-select__link">
              العربية
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../zh/practical-sessions/querying-data-using-the-wis2box-api/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../zh/" title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    实践课程
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            实践课程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/connecting-to-wis2-over-mqtt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过 MQTT 连接到 WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/accessing-your-student-vm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    访问您的学生虚拟机
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/initializing-wis2box/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    初始化 wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/configuring-wis2box-datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 wis2box 中配置数据集
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/configuring-station-metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    配置站点元数据
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/monitoring-wis2-notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    监控 WIS2 通知
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/converting-synop-data-to-bufr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过命令行将 SYNOP 数据转换为 BUFR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/converting-synop-data-to-bufr-form/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 wis2box-webapp 将 SYNOP 数据转换为 BUFR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/converting-csv-data-to-bufr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将 CSV 数据转换为 BUFR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/automating-data-ingestion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动化数据摄取
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/adding-gts-headers-to-wis2-notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向 WIS2 通知添加 GTS 头信息
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/datasets-with-access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    设置带访问控制的推荐数据集
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/downloading-data-from-wis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    从 WIS2 下载数据
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/discovering-datasets-from-wis2-gdc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 WIS2 全球发现目录中发现数据集
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/practical-sessions/querying-data-using-the-wis2box-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 wis2box API 查询数据
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    备忘单
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            备忘单
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/cheatsheets/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/cheatsheets/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/cheatsheets/wis2box/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WIS2 in a box
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    csv2bufr 模板
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            csv2bufr 模板
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/csv2bufr-templates/aws-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS 每小时
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zh/csv2bufr-templates/daycli-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAYCLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zh" class="md-nav__link">
    <span class="md-ellipsis">
      1 主页
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      2 实践课程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 实践课程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-connecting-to-wis2-over-mqtt" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 通过 MQTT 连接到 WIS2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-accessing-your-student-vm" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 访问您的学生虚拟机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-initializing-wis2box" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 初始化 wis2box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-configuring-wis2box-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 在 wis2box 中配置数据集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-configuring-station-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 配置站点元数据
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-monitoring-wis2-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 监控 WIS2 通知
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-converting-synop-data-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 通过命令行将 SYNOP 数据转换为 BUFR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-converting-synop-data-to-bufr-form" class="md-nav__link">
    <span class="md-ellipsis">
      2.8 使用 wis2box-webapp 将 SYNOP 数据转换为 BUFR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-converting-csv-data-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      2.9 将 CSV 数据转换为 BUFR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-automating-data-ingestion" class="md-nav__link">
    <span class="md-ellipsis">
      2.10 自动化数据摄取
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-adding-gts-headers-to-wis2-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      2.11 向 WIS2 通知添加 GTS 头信息
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-datasets-with-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      2.12 设置带访问控制的推荐数据集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-downloading-data-from-wis2" class="md-nav__link">
    <span class="md-ellipsis">
      2.13 从 WIS2 下载数据
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-discovering-datasets-from-wis2-gdc" class="md-nav__link">
    <span class="md-ellipsis">
      2.14 在 WIS2 全球发现目录中发现数据集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-practical-sessions-querying-data-using-the-wis2box-api" class="md-nav__link">
    <span class="md-ellipsis">
      2.15 使用 wis2box API 查询数据
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3" class="md-nav__link">
    <span class="md-ellipsis">
      3 备忘单
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 备忘单">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zh-cheatsheets-linux" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-cheatsheets-docker" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-cheatsheets-wis2box" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 WIS2 in a box
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      4 csv2bufr 模板
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 csv2bufr 模板">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zh-csv2bufr-templates-aws-template" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 AWS 每小时
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zh-csv2bufr-templates-daycli-template" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 DAYCLI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="zh" heading-number="1"><p><img alt="WMO logo" src="../zh/assets/img/wmo-logo.png" width="200"></p>
<h1 id="zh-wis2-in-a-box">WIS2 in a box 培训</h1>
<p>WIS2 in a box (<a href="https://docs.wis2box.wis.wmo.int">wis2box</a>) 是世界气象组织(WMO) WIS2节点的一个自由和开源(FOSS)参考实现。该项目提供了一个即插即用的工具集，用于使用基于标准的方法摄取、处理和发布天气/气候/水数据，符合WIS2原则。wis2box还提供对WIS2网络中所有数据的访问。wis2box旨在为数据提供者降低进入门槛，提供数据发现、访问和可视化的基础设施和服务。</p>
<p>本培训提供了关于wis2box项目各个方面的逐步解释以及多个练习，帮助您发布和下载WIS2的数据。培训以概述演示和实践练习的形式提供。</p>
<p>参与者将能够使用示例测试数据和元数据，以及整合他们自己的数据和元数据。</p>
<p>本培训涵盖了广泛的主题（安装/设置/配置、发布/下载数据等）。</p>
<h2 id="zh-_1">目标和学习成果</h2>
<p>本培训的目标是熟悉以下内容：</p>
<ul>
<li>WIS2架构的核心概念和组件</li>
<li>WIS2中用于发现和访问的数据和元数据格式</li>
<li>wis2box架构和环境</li>
<li>wis2box的核心功能：<ul>
<li>元数据管理</li>
<li>数据摄取和转换为BUFR格式</li>
<li>MQTT代理用于WIS2消息发布</li>
<li>HTTP端点用于数据下载</li>
<li>API端点用于程序化访问数据</li>
</ul>
</li>
</ul>
<h2 id="zh-_2">导航</h2>
<p>左侧导航提供了整个培训的目录。</p>
<p>右侧导航提供了特定页面的目录。</p>
<h2 id="zh-_3">先决条件</h2>
<h3 id="zh-_4">知识</h3>
<ul>
<li>基本的Linux命令（见<a href="#zh-cheatsheets-linux">备忘单</a>）</li>
<li>网络和互联网协议的基本知识</li>
</ul>
<h3 id="zh-_5">软件</h3>
<p>本培训需要以下工具：</p>
<ul>
<li>运行Ubuntu OS的实例（在本地培训会议期间由WMO培训师提供），见<a href="#zh-practical-sessions-accessing-your-student-vm-introduction">访问您的学生VM</a></li>
<li>SSH客户端访问您的实例</li>
<li>在您的本地机器上的MQTT Explorer</li>
<li>SCP和FTP客户端从您的本地机器复制文件</li>
</ul>
<h2 id="zh-_6">约定</h2>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>这样标记的部分邀请您回答一个问题。</p>
</div>
<p>您还会注意到文本中有提示和注释部分：</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>提示分享如何最好地完成任务。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>注释提供了关于实践课程所涵盖主题的额外信息，以及如何最好地完成任务。</p>
</div>
<p>示例如下所示：</p>
<p>配置
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">my-collection-defined-in-yaml</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my title defined as a yaml attribute named title</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my description as a yaml attribute named description</span>
</code></pre></div></td></tr></table></div></p>
<p>需要在终端/控制台上输入的代码片段表示为：</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Hello world&#39;</span>
</code></pre></div>
<p>运行中的容器名称（运行的镜像）用<strong>粗体</strong>表示。</p>
<h2 id="zh-_7">培训地点和材料</h2>
<p>培训内容、wiki和问题跟踪器在GitHub上管理，网址为<a href="https://github.com/wmo-im/wis2box-training">https://github.com/wmo-im/wis2box-training</a>。</p>
<h2 id="zh-_8">打印材料</h2>
<p>这个培训可以导出为PDF。要保存或打印这个培训材料，请转到<a href="#zh-print_page">打印页面</a>，然后选择
文件 &gt; 打印 &gt; 保存为PDF。</p>
<h2 id="zh-_9">练习材料</h2>
<p>练习材料可以从<a href="/exercise-materials.zip">exercise-materials.zip</a>压缩文件下载。</p>
<h2 id="zh-_10">支持</h2>
<p>对于问题/错误/建议或对本培训的改进/贡献，请使用<a href="https://github.com/wmo-im/wis2box-training/issues">GitHub问题跟踪器</a>。</p>
<p>所有wis2box的错误、增强和问题可以在<a href="https://github.com/wmo-im/wis2box/issues">GitHub</a>上报告。</p>
<p>如需额外支持或有问题，请联系 wis2-support@wmo.int。</p>
<p>如常，wis2box的核心文档始终可以在<a href="https://docs.wis2box.wis.wmo.int">https://docs.wis2box.wis.wmo.int</a>找到。</p>
<p>欢迎并鼓励贡献！</p></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>实践课程<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="zh-practical-sessions-connecting-to-wis2-over-mqtt" heading-number="2.1"><h1 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-mqtt-wis2">通过 MQTT 连接到 WIS2</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>通过本实践课程，您将能够：</p>
<ul>
<li>使用 MQTT Explorer 连接到 WIS2 全球代理</li>
<li>查看 WIS2 主题结构</li>
<li>查看 WIS2 通知消息结构</li>
</ul>
</div>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-_1">引言</h2>
<p>WIS2 使用 MQTT 协议来宣传天气/气候/水数据的可用性。WIS2 全球代理订阅网络中所有 WIS2 节点的消息，并重新发布它接收到的消息。全球缓存订阅全球代理，下载消息中的数据，然后在 <code>cache</code> 主题上用新的 URL 重新发布消息。全球发现目录从代理发布发现元数据并提供搜索 API。</p>
<p>这是一个在主题 <code>origin/a/wis2/br-inmet/data/core/weather/surface-based-observations/synop</code> 上接收到的 WIS2 通知消息结构的示例：</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;59f9b013-c4b3-410a-a52d-fff18f3f1b47&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v04&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="mf">-38.69389</span><span class="p">,</span>
<span class="w">      </span><span class="mf">-17.96472</span><span class="p">,</span>
<span class="w">      </span><span class="mi">60</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;data_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;br-inmet/data/core/weather/surface-based-observations/synop/WIGOS_0-76-2-2900801000W83499_20240815T060000&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;datetime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-08-15T06:00:00Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pubtime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-08-15T09:52:02Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;integrity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sha512&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TBuWycx/G0lIiTo47eFPBViGutxcIyk7eikppAKPc4aHgOmTIS5Wb9+0v3awMOyCgwpFhTruRRCVReMQMp5kYw==&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;encoding&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;base64&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;QlVGUgAA+gQAABYAACsAAAAAAAIAHAAH6AgPBgAAAAALAAABgMGWx1AAAM0ABOIAAAODM0OTkAAAAAAAAAAAAAAKb5oKEpJ6YkJ6mAAAAAAAAAAAAAAAAv0QeYA29WQa87ZhH4CQP//z+P//BD////+ASznXuUb///8MgAS3/////8X///e+AP////AB/+R/yf////////////////////6/1/79H/3///gEt////////4BLP6QAf/+/pAB//4H0YJ/YeAh/f2///7TH/////9+j//f///////////////////v0f//////////////////////wNzc3Nw==&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;wigos_station_identifier&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0-76-2-2900801000W83499&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;canonical&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;application/bufr&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://wis2bra.inmet.gov.br/data/2024-08-15/wis/br-inmet/data/core/weather/surface-based-observations/synop/WIGOS_0-76-2-2900801000W83499_20240815T060000.bufr4&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>在本实践课程中，您将学习如何使用 MQTT Explorer 工具设置 MQTT 客户端连接到 WIS2 全球代理，并能够显示 WIS2 通知消息。</p>
<p>MQTT Explorer 是一个有用的工具，用于浏览和查看给定 MQTT 代理的主题结构以及正在发布的数据。</p>
<p>请注意，MQTT 主要用于“机器对机器”的通信；这意味着通常会有一个客户端自动解析接收到的消息。要以编程方式使用 MQTT（例如，在 Python 中），您可以使用 MQTT 客户端库，如 <a href="https://pypi.org/project/paho-mqtt">paho-mqtt</a>，连接到 MQTT 代理并处理传入消息。根据您的需求和技术环境，存在许多 MQTT 客户端和服务器软件。</p>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-mqtt-explorer">使用 MQTT Explorer 连接到全球代理</h2>
<p>要查看由 WIS2 全球代理发布的消息，您可以使用“MQTT Explorer”，该工具可以从 <a href="https://mqtt-explorer.com">MQTT Explorer 网站</a>下载。</p>
<p>打开 MQTT Explorer 并使用以下详细信息添加新连接到由 MeteoFrance 托管的全球代理：</p>
<ul>
<li>主机：globalbroker.meteo.fr</li>
<li>端口：8883</li>
<li>用户名：everyone</li>
<li>密码：everyone</li>
</ul>
<p><img alt="mqtt-explorer-global-broker-connection" src="../zh/assets/img/mqtt-explorer-global-broker-connection.png" width="800"></p>
<p>点击 'ADVANCED' 按钮，删除预配置的主题并添加以下主题进行订阅：</p>
<ul>
<li><code>origin/a/wis2/#</code></li>
</ul>
<p><img alt="mqtt-explorer-global-broker-advanced" src="../zh/assets/img/mqtt-explorer-global-broker-sub-origin.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>设置 MQTT 订阅时，您可以使用以下通配符：</p>
<ul>
<li><strong>单级 (+)</strong>：单级通配符替换一个主题级别</li>
<li><strong>多级 (#)</strong>：多级通配符替换多个主题级别</li>
</ul>
<p>在这种情况下，<code>origin/a/wis2/#</code> 将订阅 <code>origin/a/wis2</code> 主题下的所有主题。</p>
</div>
<p>点击 'BACK'，然后 'SAVE' 保存您的连接和订阅详情。然后点击 'CONNECT'：</p>
<p>消息应该开始在您的 MQTT Explorer 会话中出现，如下所示：</p>
<p><img alt="mqtt-explorer-global-broker-topics" src="../zh/assets/img/mqtt-explorer-global-broker-msg-origin.png" width="800"></p>
<p>现在您已经准备好开始探索 WIS2 的主题和消息结构。</p>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-1-wis2">练习 1：查看 WIS2 主题结构</h2>
<p>使用 MQTT 浏览 <code>origin</code> 主题下的主题结构。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何区分发布数据的 WIS 中心？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>您可以点击 MQTT Explorer 中左侧窗口以展开主题结构。</p>
<p>我们可以通过查看主题结构的第四级来区分发布数据的 WIS 中心。例如，以下主题：</p>
<p><code>origin/a/wis2/br-inmet/data/core/weather/surface-based-observations/synop</code></p>
<p>告诉我们数据是由巴西国家气象学院 - INMET 发布的，中心 ID 为 <code>br-inmet</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何区分由托管 GTS 到 WIS2 网关的 WIS 中心发布的消息和由托管 WIS2 节点的 WIS 中心发布的消息？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>我们可以通过查看主题结构中的中心 ID 来区分来自 GTS 到 WIS2 网关的消息。例如，以下主题：</p>
<p><code>origin/a/wis2/de-dwd-gts-to-wis2/data/core/I/S/A/I/01/sbbr</code></p>
<p>告诉我们数据是由德国气象局 (DWD) 托管的 GTS 到 WIS2 网关发布的。GTS 到 WIS2 网关是一种特殊类型的数据发布者，它将全球电信系统 (GTS) 的数据发布到 WIS2。主题结构由 GTS 消息的 TTAAii CCCC 头组成。</p>
</details>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-2-wis2">练习 2：查看 WIS2 消息结构</h2>
<p>从 MQTT Explorer 断开连接并更新 'Advanced' 部分以更改订阅为以下内容：</p>
<ul>
<li><code>origin/a/wis2/+/data/core/weather/surface-based-observations/synop</code></li>
<li><code>cache/a/wis2/+/data/core/weather/surface-based-observations/synop</code></li>
</ul>
<p><img alt="mqtt-explorer-global-broker-topics-exercise2" src="../zh/assets/img/mqtt-explorer-global-broker-sub-origin-cache-synop.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>+</code> 通配符用于订阅所有 WIS 中心。</p>
</div>
<p>重新连接到全球代理并等待消息出现。</p>
<p>您可以在右侧的“Value”部分查看 WIS2 消息的内容。尝试展开主题结构以查看消息的不同级别，直到您到达最后一级并查看其中一条消息的消息内容。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何识别数据发布的时间戳？我们又如何识别数据收集的时间戳？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>数据发布的时间戳包含在消息的 <code>properties</code> 部分，键为 <code>pubtime</code>。</p>
<p>数据收集的时间戳包含在消息的 <code>properties</code> 部分，键为 <code>datetime</code>。</p>
<p><img alt="mqtt-explorer-global-broker-msg-properties" src="../zh/assets/img/mqtt-explorer-global-broker-msg-properties.png" width="800"></p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何从消息中提供的 URL 下载数据？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>URL 包含在 <code>links</code> 部分，<code>rel="canonical"</code> 并由 <code>href</code> 键定义。</p>
<p>您可以复制 URL 并将其粘贴到网络浏览器中以下载数据。</p>
</details>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-3-origin-cache">练习 3：查看 'origin' 和 'cache' 主题之间的区别</h2>
<p>确保您仍然使用在练习 2 中描述的主题订阅 <code>origin/a/wis2/+/data/core/weather/surface-based-observations/synop</code> 和 <code>cache/a/wis2/+/data/core/weather/surface-based-observations/synop</code> 连接到全球代理。</p>
<p>尝试识别在 <code>origin</code> 和 <code>cache</code> 主题上发布的同一中心 ID 的消息。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>发布在 <code>origin</code> 和 <code>cache</code> 主题上的消息有什么区别？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>发布在 <code>origin</code> 主题上的消息是全球代理从 WIS2 节点网络中重新发布的原始消息。</p>
<p>发布在 <code>cache</code> 主题上的消息是全球缓存下载的数据的消息。如果您检查以 <code>cache</code> 开头的主题的消息内容，您会看到 'canonical' 链接已更新为新的 URL。</p>
<p>WIS2 网络中有多个全球缓存，因此您将收到每个下载了该消息的全球缓存的一条消息。</p>
<p>全球缓存只会下载并重新发布在 <code>../data/core/...</code> 主题层次结构上发布的消息。</p>
</details>
<h2 id="zh-practical-sessions-connecting-to-wis2-over-mqtt-_2">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学到了：</p>
<ul>
<li>如何使用 MQTT Explorer 订阅 WIS2 全球代理服务</li>
<li>WIS2 主题结构</li>
<li>WIS2 通知消息结构</li>
<li>核心数据和推荐数据的区别</li>
<li>GTS 到 WIS2 网关使用的主题结构</li>
<li>全球代理在 <code>origin</code> 和 <code>cache</code> 主题上发布的消息的区别</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-accessing-your-student-vm" heading-number="2.2"><h1 id="zh-practical-sessions-accessing-your-student-vm-_1">访问您的学生虚拟机</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>通过本实践课程，您将能够：</p>
<ul>
<li>通过 SSH 和 WinSCP 访问您的学生虚拟机</li>
<li>验证实践练习所需软件是否已安装</li>
<li>确认您可以在本地学生虚拟机上访问本次培训的练习材料</li>
</ul>
</div>
<h2 id="zh-practical-sessions-accessing-your-student-vm-_2">引言</h2>
<p>作为本地运行的 wis2box 培训课程的一部分，您可以在名为“WIS2-training”的本地培训网络上访问您的个人学生虚拟机。</p>
<p>您的学生虚拟机已预装以下软件：</p>
<ul>
<li>Ubuntu 22.0.4.3 LTS <a href="https://releases.ubuntu.com/jammy/ubuntu-22.04.3-live-server-amd64.iso">ubuntu-22.04.3-live-server-amd64.iso</a></li>
<li>Python 3.10.12</li>
<li>Docker 24.0.6</li>
<li>Docker Compose 2.21.0</li>
<li>文本编辑器：vim, nano</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>如果您想在本地培训课程之外进行此培训，您可以使用任何云服务提供商提供自己的实例，例如：</p>
<ul>
<li>GCP（谷歌云平台）VM 实例 <code>e2-medium</code></li>
<li>AWS（亚马逊网络服务）ec2 实例 <code>t3a.medium</code></li>
<li>Azure（微软）Azure 虚拟机 <code>standard_b2s</code></li>
</ul>
<p>选择 Ubuntu Server 22.0.4 LTS 作为操作系统。</p>
<p>创建您的虚拟机后，请确保已安装 python、docker 和 docker compose，如 <a href="https://docs.wis2box.wis.wmo.int/en/latest/user/getting-started.html#software-dependencies">wis2box-software-dependencies</a> 所述。</p>
<p>本次培训中使用的 wis2box 发布档案可以通过以下方式下载：</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://github.com/wmo-im/wis2box/releases/download/1.0.0rc1/wis2box-setup-1.0.0rc1.zip
unzip<span class="w"> </span>wis2box-setup-1.0.0rc1.zip
</code></pre></div>
<p>您可以在 <a href="https://github.com/wmo-im/wis2box/releases">https://github.com/wmo-im/wis2box/releases</a> 找到最新的 'wis2box-setup' 档案。</p>
<p>本次培训使用的练习材料可以通过以下方式下载：</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://training.wis2box.wis.wmo.int/exercise-materials.zip
unzip<span class="w"> </span>exercise-materials.zip
</code></pre></div>
<p>运行练习材料需要以下额外的 Python 包：</p>
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>minio
</code></pre></div>
<p>如果您在本地 WIS2 培训课程中使用提供的学生虚拟机，所需软件将已经安装。</p>
</div>
<h2 id="zh-practical-sessions-accessing-your-student-vm-_3">在本地培训网络上连接到您的学生虚拟机</h2>
<p>按照培训师提供的指示，将您的 PC 连接到 WIS2 培训期间在教室内广播的本地 Wi-Fi。</p>
<p>使用 SSH 客户端使用以下信息连接到您的学生虚拟机：</p>
<ul>
<li><strong>主机：（在面对面培训中提供）</strong></li>
<li><strong>端口：22</strong></li>
<li><strong>用户名：（在面对面培训中提供）</strong></li>
<li><strong>密码：（在面对面培训中提供）</strong></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>如果您不确定主机名/用户名或连接有问题，请联系培训师。</p>
</div>
<p>连接后，请更改您的密码以确保其他人无法访问您的虚拟机：</p>
<div class="highlight"><pre><span></span><code>limper@student-vm:~$<span class="w"> </span>passwd
更改<span class="w"> </span>testuser<span class="w"> </span>的密码。
当前密码：
新密码：
重新输入新密码：
passwd:<span class="w"> </span>密码更新成功
</code></pre></div>
<h2 id="zh-practical-sessions-accessing-your-student-vm-_4">验证软件版本</h2>
<p>为了能够运行 wis2box，学生虚拟机应预装 Python、Docker 和 Docker Compose。</p>
<p>检查 Python 版本：
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>--version
</code></pre></div>
返回：
<div class="highlight"><pre><span></span><code><span class="go">Python 3.10.12</span>
</code></pre></div></p>
<p>检查 Docker 版本：
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>--version
</code></pre></div>
返回：
<div class="highlight"><pre><span></span><code><span class="go">Docker version 24.0.6, build ed223bc</span>
</code></pre></div></p>
<p>检查 Docker Compose 版本：
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>version
</code></pre></div>
返回：
<div class="highlight"><pre><span></span><code><span class="go">Docker Compose version v2.21.0</span>
</code></pre></div></p>
<p>为确保您的用户可以运行 Docker 命令，您的用户已被添加到 <code>docker</code> 组。</p>
<p>测试您的用户是否可以运行 docker hello-world，运行以下命令：
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>hello-world
</code></pre></div></p>
<p>这应该会拉取 hello-world 镜像并运行一个打印消息的容器。</p>
<p>检查您的输出中是否显示以下内容：</p>
<div class="highlight"><pre><span></span><code><span class="go">...</span>
<span class="go">Hello from Docker!</span>
<span class="go">This message shows that your installation appears to be working correctly.</span>
<span class="go">...</span>
</code></pre></div>
<h2 id="zh-practical-sessions-accessing-your-student-vm-_5">检查练习材料</h2>
<p>检查您的主目录内容；这些是作为培训和实践课程的一部分使用的材料。</p>
<p><div class="highlight"><pre><span></span><code>ls<span class="w"> </span>~/
</code></pre></div>
返回：
<div class="highlight"><pre><span></span><code><span class="go">exercise-materials  wis2box-1.0.0rc1</span>
</code></pre></div></p>
<p>如果您的本地 PC 上安装了 WinSCP，您可以使用它连接到您的学生虚拟机，并检查您的主目录内容以及在您的虚拟机和本地 PC 之间下载或上传文件。</p>
<p>WinSCP 不是培训所必需的，但如果您想在本地 PC 上使用文本编辑器编辑虚拟机上的文件，它可能会很有用。</p>
<p>以下是使用 WinSCP 连接到您的学生虚拟机的方法：</p>
<p>打开 WinSCP 并点击“新站点”。您可以如下创建一个新的 SCP 连接到您的虚拟机：</p>
<p><img alt="winscp-student-vm-scp.png" src="../zh/assets/img/winscp-student-vm-scp.png" width="400"></p>
<p>点击“保存”然后“登录”以连接到您的虚拟机。</p>
<p>您应该能够看到以下内容：</p>
<p><img alt="winscp-student-vm-exercise-materials.png" src="../zh/assets/img/winscp-student-vm-exercise-materials.png" width="600"></p>
<h2 id="zh-practical-sessions-accessing-your-student-vm-_6">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了：</p>
<ul>
<li>通过 SSH 和 WinSCP 访问您的学生虚拟机</li>
<li>验证实践练习所需软件是否已安装</li>
<li>确认您可以在本地学生虚拟机上访问本次培训的练习材料</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-initializing-wis2box" heading-number="2.3"><h1 id="zh-practical-sessions-initializing-wis2box-wis2box">初始化 wis2box</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>运行 <code>wis2box-create-config.py</code> 脚本创建初始配置</li>
<li>启动 wis2box 并检查其组件的状态</li>
<li>在浏览器中访问 <strong>wis2box-webapp</strong>、API、MinIO UI 和 Grafana 仪表板</li>
<li>使用 MQTT Explorer 连接到本地的 <strong>wis2box-broker</strong></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>当前的培训材料使用的是 wis2box-1.0.0rc1。</p>
<p>如果您在本地培训课程之外运行此培训，请参阅 <a href="#zh-practical-sessions-accessing-your-student-vm">accessing-your-student-vm</a> 了解如何下载和安装 wis2box 软件堆栈的指南。</p>
</div>
<h2 id="zh-practical-sessions-initializing-wis2box-_1">准备工作</h2>
<p>使用您的用户名和密码登录到指定的 VM，并确保您位于 <code>wis2box-1.0.0rc1</code> 目录中：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
</code></pre></div>
<h2 id="zh-practical-sessions-initializing-wis2box-_2">创建初始配置</h2>
<p>wis2box 的初始配置需要：</p>
<ul>
<li>一个包含配置参数的环境文件 <code>wis2box.env</code></li>
<li>由环境变量 <code>WIS2BOX_HOST_DATADIR</code> 定义的主机上的目录，用于主机和 wis2box 容器之间的共享</li>
</ul>
<p>可以使用 <code>wis2box-create-config.py</code> 脚本来创建您的 wis2box 的初始配置。</p>
<p>它将询问您一系列问题以帮助设置您的配置。</p>
<p>脚本完成后，您将能够查看和更新配置文件。</p>
<p>按以下方式运行脚本：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-create-config.py
</code></pre></div>
<h3 id="zh-practical-sessions-initializing-wis2box-wis2box-host-data">wis2box-host-data 目录</h3>
<p>脚本将要求您输入用于 <code>WIS2BOX_HOST_DATADIR</code> 环境变量的目录。</p>
<p>请注意，您需要定义此目录的完整路径。</p>
<p>例如，如果您的用户名是 <code>username</code>，则目录的完整路径为 <code>/home/username/wis2box-data</code>：</p>
<div class="highlight"><pre><span></span><code>username@student-vm-username:~/wis2box-1.0.0rc1$ python3 wis2box-create-config.py
请输入用于 WIS2BOX_HOST_DATADIR 的目录：
/home/username/wis2box-data
将设置用于 WIS2BOX_HOST_DATADIR 的目录为：
    /home/username/wis2box-data
这是正确的吗？(y/n/exit)
y
已创建目录 /home/username/wis2box-data。
</code></pre></div>
<h3 id="zh-practical-sessions-initializing-wis2box-wis2box-url">wis2box URL</h3>
<p>接下来，您将被要求输入您的 wis2box 的 URL。这是用于访问 wis2box 网络应用程序、API 和 UI 的 URL。</p>
<p>请使用 <code>http://&lt;your-hostname-or-ip&gt;</code> 作为 URL。</p>
<div class="highlight"><pre><span></span><code>请输入 wis2box 的 URL：
 对于本地测试，URL 是 http://localhost
 若要启用远程访问，URL 应指向托管 wis2box 的服务器的公共 IP 地址或域名。
http://username.wis2.training
将设置 wis2box 的 URL 为：
  http://username.wis2.training
这是正确的吗？(y/n/exit)
</code></pre></div>
<h3 id="zh-practical-sessions-initializing-wis2box-webappstorage-broker">WEBAPP、STORAGE 和 BROKER 密码</h3>
<p>在提示输入 <code>WIS2BOX_WEBAPP_PASSWORD</code>、<code>WIS2BOX_STORAGE_PASSWORD</code>、<code>WIS2BOX_BROKER_PASSWORD</code> 时，您可以选择生成随机密码，并定义您自己的密码。</p>
<p>不用担心记住这些密码，它们将被存储在您的 wis2box-1.0.0rc1 目录中的 <code>wis2box.env</code> 文件中。</p>
<h3 id="zh-practical-sessions-initializing-wis2box-wis2boxenv">查看 <code>wis2box.env</code></h3>
<p>脚本完成后检查当前目录中 <code>wis2box.env</code> 文件的内容：</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>~/wis2box-1.0.0rc1/wis2box.env
</code></pre></div>
<p>或通过 WinSCP 检查文件的内容。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p><code>wis2box.env</code> 文件中 WISBOX_BASEMAP_URL 的值是什么？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>WIS2BOX_BASEMAP_URL 的默认值是 <code>https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png</code>。</p>
<p>此 URL 指向 OpenStreetMap 瓦片服务器。如果您想使用不同的地图提供商，可以将此 URL 更改为指向不同的瓦片服务器。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p><code>wis2box.env</code> 文件中 WIS2BOX_STORAGE_DATA_RETENTION_DAYS 环境变量的值是多少？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>WIS2BOX_STORAGE_DATA_RETENTION_DAYS 的默认值是 30 天。如果您愿意，可以将此值更改为不同的天数。</p>
<p>wis2box-management 容器每天运行一次 cronjob，从 <code>wis2box-public</code> 存储桶和 API 后端删除超过 WIS2BOX_STORAGE_DATA_RETENTION_DAYS 定义的天数的数据：</p>
<div class="highlight"><pre><span></span><code>0 0 * * * su wis2box -c &quot;wis2box data clean --days=$WIS2BOX_STORAGE_DATA_RETENTION_DAYS&quot;
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>wis2box.env</code> 文件包含定义您的 wis2box 配置的环境变量。有关更多信息，请参阅 <a href="https://docs.wis2box.wis.wmo.int/en/latest/reference/configuration.html">wis2box-documentation</a>。</p>
<p>除非您确定要进行的更改，请不要编辑 <code>wis2box.env</code> 文件。不正确的更改可能导致您的 wis2box 停止工作。</p>
<p>不要与任何人分享您的 <code>wis2box.env</code> 文件的内容，因为它包含敏感信息，如密码。</p>
</div></section><section class="print-page" id="zh-practical-sessions-configuring-wis2box-datasets" heading-number="2.4"><h1 id="zh-practical-sessions-configuring-wis2box-datasets-wis2box">在 wis2box 中配置数据集</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>创建一个新的数据集</li>
<li>为数据集创建发现元数据</li>
<li>配置数据集的数据映射</li>
<li>发布带有 WCMP2 记录的 WIS2 通知</li>
<li>更新并重新发布您的数据集</li>
</ul>
</div>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_1">引言</h2>
<p>wis2box 使用与发现元数据和数据映射相关联的数据集。</p>
<p>发现元数据用于创建 WCMP2（世界气象组织核心元数据配置文件 2）记录，该记录通过在您的 wis2box-broker 上发布的 WIS2 通知共享。</p>
<p>数据映射用于将数据插件关联到您的输入数据，允许您的数据在使用 WIS2 通知发布之前进行转换。</p>
<p>本课程将指导您创建新的数据集、创建发现元数据和配置数据映射。您将在 wis2box-api 中检查您的数据集，并审查您的发现元数据的 WIS2 通知。</p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_2">准备</h2>
<p>使用 MQTT Explorer 连接到您的 broker。</p>
<p>使用公共凭证 <code>everyone/everyone</code> 而不是使用您的内部 broker 凭证：</p>
<p><img alt="MQTT Explorer: 连接到 broker" src="../zh/assets/img/mqtt-explorer-wis2box-broker-everyone-everyone.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>您永远不需要与外部用户共享您的内部 broker 的凭证。'everyone' 用户是一个公共用户，用于启用 WIS2 通知的共享。</p>
<p><code>everyone/everyone</code> 凭证在主题 'origin/a/wis2/#' 上具有只读访问权限。这是发布 WIS2 通知的主题。全球 Broker 可以使用这些公共凭证订阅以接收通知。</p>
<p>'everyone' 用户将无法看到内部主题或能够发布消息。</p>
</div>
<p>打开浏览器并打开页面 <code>http://&lt;your-host&gt;/wis2box-webapp</code>。确保您已登录并可以访问 '数据集编辑器' 页面。</p>
<p>如果您需要记住如何连接到 broker 或访问 wis2box-webapp，请参阅<a href="#practical-sessions-initializing-wis2box">初始化 wis2box</a>部分。</p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-processeswis2box">为 processes/wis2box 创建授权令牌</h2>
<p>您将需要 'processes/wis2box' 端点的授权令牌来发布您的数据集。</p>
<p>要创建授权令牌，请通过 SSH 访问您的培训 VM，并使用以下命令登录到 wis2box-management 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>然后运行以下命令为 'processes/wis2box' 端点创建一个随机生成的授权令牌：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>auth<span class="w"> </span>add-token<span class="w"> </span>--path<span class="w"> </span>processes/wis2box
</code></pre></div>
<p>您也可以通过将令牌作为参数提供给命令，创建一个具有特定值的令牌：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>auth<span class="w"> </span>add-token<span class="w"> </span>--path<span class="w"> </span>processes/wis2box<span class="w"> </span>MyS3cretToken
</code></pre></div>
<p>确保复制令牌值并将其存储在您的本地机器上，因为您稍后将需要它。</p>
<p>获取您的令牌后，您可以退出 wis2box-management 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-wis2box-webapp">在 wis2box-webapp 中创建新的数据集</h2>
<p>通过转到 <code>http://&lt;your-host&gt;/wis2box-webapp</code> 并从左侧菜单中选择 '数据集编辑器'，导航到您的 wis2box 实例的 '数据集编辑器' 页面。</p>
<p>在 '数据集编辑器' 页面的 '数据集' 选项卡下，点击 "创建新的 ..."：</p>
<p><img alt="创建新的数据集" src="../zh/assets/img/wis2box-create-new-dataset.png" width="800"></p>
<p>将出现一个弹出窗口，要求您提供：</p>
<ul>
<li><strong>中心 ID</strong>：这是由 WMO 成员指定的、用于标识负责发布数据的数据中心的机构缩写（小写且无空格）。</li>
<li><strong>数据类型</strong>：您正在为其创建元数据的数据类型。您可以选择使用预定义的模板或选择 '其他'。如果选择 '其他'，则必须手动填写更多字段。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">中心 ID</p>
<p>您的中心 ID 应以您国家的顶级域名开头，后跟一个缩写的组织名称（例如 <code>fr-meteofrance</code>）。中心 ID 必须使用小写字母并且只能使用字母数字字符。下拉列表显示了 WIS2 上当前注册的所有中心 ID 以及您在 wis2box 中已创建的任何中心 ID。</p>
</div>
<div class="admonition note">
<p class="admonition-title">数据类型模板</p>
<p><em>数据类型</em> 字段允许您从 wis2box-webapp 数据集编辑器中可用的模板列表中选择。模板将使用适用于数据类型的建议默认值预填充表单。这包括元数据的建议标题和关键字以及预配置的数据插件。主题将固定为数据类型的默认主题。</p>
<p>为了培训的目的，我们将使用 <em>weather/surface-based-observations/synop</em> 数据类型，该数据类型包括确保数据转换为 BUFR 格式的数据插件。</p>
<p>如果您想使用 wis2box 发布 CAP 警报，请使用模板 <em>weather/advisories-warnings</em>。此模板包含一个数据插件，用于验证输入数据是否为有效的 CAP 警报，然后发布。要创建 CAP 警报并通过 wis2box 发布，您可以使用 <a href="https://github.com/wmo-raf/cap-composer">CAP Composer</a>。</p>
</div>
<p>请选择适合您组织的中心 ID。</p>
<p>对于<strong>数据类型</strong>，请选择<strong>weather/surface-based-observations/synop</strong>：</p>
<p><img alt="创建新数据集表单：初始信息" src="../zh/assets/img/wis2box-create-new-dataset-form-initial.png" width="450"></p>
<p>点击 <em>继续填写表单</em> 以继续，现在您将看到 <strong>数据集编辑器表单</strong>。</p>
<p>由于您选择了 <strong>weather/surface-based-observations/synop</strong> 数据类型，表单将预填充一些与此数据类型相关的初始值。</p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_3">创建发现元数据</h2>
<p>数据集编辑器表单允许您为您的数据集提供发现元数据，wis2box-management 容器将使用这些元数据发布 WCMP2 记录。</p>
<p>由于您选择了 'weather/surface-based-observations/synop' 数据类型，表单将预填充一些默认值。</p>
<p>请确保将自动生成的 '本地 ID' 替换为描述性名称，例如 'synop-dataset-wis2training'：</p>
<p><img alt="元数据编辑器：标题、描述、关键字" src="../zh/assets/img/wis2box-metadata-editor-part1.png" width="800"></p>
<p>审查标题和关键字，并根据需要进行更新，并为您的数据集提供描述。</p>
<p>注意有选项可以将 'WMO 数据政策' 从 '核心' 更改为 '推荐' 或修改您的默认元数据标识符，请将数据政策保持为 '核心' 并使用默认元数据标识符。</p>
<p>接下来，审查定义您的 '时间属性' 和 '空间属性' 的部分。您可以通过更新 '北纬'、'南纬'、'东经' 和 '西经' 字段来调整边界框：</p>
<p><img alt="元数据编辑器：时间属性、空间属性" src="../zh/assets/img/wis2box-metadata-editor-part2.png" width="800"></p>
<p>接下来，填写定义 '数据提供者的联系信息' 的部分：</p>
<p><img alt="元数据编辑器：联系信息" src="../zh/assets/img/wis2box-metadata-editor-part3.png" width="800"></p>
<p>最后，填写定义 '数据质量信息' 的部分：</p>
<p>填写完所有部分后，点击 '验证表单' 并检查表单是否有任何错误：</p>
<p><img alt="元数据编辑器：验证" src="../zh/assets/img/wis2box-metadata-validation-error.png" width="800"></p>
<p>如果有任何错误，请更正它们并再次点击 '验证表单'。</p>
<p>确保您没有错误，并且您得到一个弹出提示，表明您的表单已通过验证：</p>
<p><img alt="元数据编辑器：验证成功" src="../zh/assets/img/wis2box-metadata-validation-success.png" width="800"></p>
<p>接下来，在提交您的数据集之前，审查您的数据集的数据映射。</p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_4">配置数据映射</h2>
<p>由于您使用模板创建了数据集，因此数据集映射已使用 'weather/surface-based-observations/synop' 数据类型的默认插件预填充。数据插件用于在使用 WIS2 通知发布之前转换 wis2box 中的数据。</p>
<p><img alt="数据映射：更新插件" src="../zh/assets/img/wis2box-data-mappings.png" width="800"></p>
<p>请注意，您可以点击“更新”按钮更改插件的设置，例如文件扩展名和文件模式，现在您可以保留默认设置。在后续课程中，您将了解更多关于 BUFR 和数据转换为 BUFR 格式的信息。</p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_5">提交您的数据集</h2>
<p>最后，您可以点击 '提交' 来发布您的数据集。</p>
<p>您需要提供您之前创建的 'processes/wis2box' 的授权令牌。如果您尚未这样做，可以按照准备部分中的说明创建新令牌。</p>
<p>提交您的数据集后，检查您是否收到以下消息，表明数据集已成功提交：</p>
<p><img alt="提交数据集成功" src="../zh/assets/img/wis2box-submit-dataset-success.png" width="400"></p>
<p>点击 '确定' 后，您将被重定向到数据集编辑器主页。现在如果您点击 '数据集' 选项卡，您应该会看到您的新数据集列出：</p>
<p><img alt="数据集编辑器：新数据集" src="../zh/assets/img/wis2box-dataset-editor-new-dataset.png" width="800"></p>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-wis2">审查您的发现元数据的 WIS2 通知</h2>
<p>转到 MQTT Explorer，如果您已连接到 broker，您应该会看到在主题 <code>origin/a/wis2/&lt;your-centre-id&gt;/metadata</code> 上发布的新 WIS2 通知：</p>
<p><img alt="MQTT Explorer：WIS2 通知" src="../zh/assets/img/mqtt-explorer-wis2-notification-metadata.png" width="800"></p>
<p>检查您发布的 WIS2 通知的内容。您应该会看到一个与 WIS 通知消息 (WNM) 格式相对应的结构的 JSON。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>WIS2 通知是在哪个主题上发布的？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>WIS2 通知是在主题 <code>origin/a/wis2/&lt;your-centre-id&gt;/metadata</code> 上发布的。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>尝试在 WIS2 通知中找到您在发现元数据中提供的标题、描述和关键字。您能找到它们吗？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>请注意，您在发现元数据中提供的标题、描述和关键字<strong>不</strong>出现在 WIS2 通知有效负载中！</p>
<p>相反，请尝试在 WIS2 通知的“链接”部分查找规范链接：</p>
<p><img alt="WIS2 通知元数据，链接部分" src="../zh/assets/img/wis2-notification-metadata-links.png" width="800"></p>
<p>WIS2 通知包含指向已发布 WCMP2 记录的规范链接。如果您将此链接复制粘贴到浏览器中，您将下载 WCMP2 记录并看到您提供的标题、描述和关键字。</p>
</details>
<h2 id="zh-practical-sessions-configuring-wis2box-datasets-_6">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学习了如何：</p>
<ul>
<li>创建一个新的数据集</li>
<li>定义您的发现元数据</li>
<li>审查您的数据映射</li>
<li>发布发现元数据</li>
<li>审查您的发现元数据的 WIS2 通知</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-configuring-station-metadata" heading-number="2.5"><h1 id="zh-practical-sessions-configuring-station-metadata-_1">配置站点元数据</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>为 <code>collections/stations</code> 端点创建一个授权令牌</li>
<li>向 wis2box 添加站点元数据</li>
<li>使用 <strong>wis2box-webapp</strong> 更新/删除站点元数据</li>
</ul>
</div>
<h2 id="zh-practical-sessions-configuring-station-metadata-_2">引言</h2>
<p>为了在世界气象组织（WMO）成员国之间共享数据，了解产生数据的站点至关重要。世界一体化全球观测系统（WIGOS）提供了一个整合观测系统和数据管理系统的框架。<strong>WIGOS 站点标识符（WSI）</strong> 被用作产生特定观测数据集的站点的唯一参考。</p>
<p>wis2box 拥有一个站点元数据集合，用于描述产生观测数据的站点，并应从 <strong>OSCAR/Surface</strong> 检索。wis2box 中的站点元数据被 BUFR 转换工具用来检查输入数据是否包含有效的 WIGOS 站点标识符（WSI）并提供 WSI 与站点元数据之间的映射。</p>
<h2 id="zh-practical-sessions-configuring-station-metadata-collectionsstations">为 collections/stations 创建授权令牌</h2>
<p>要通过 <strong>wis2box-webapp</strong> 编辑站点，您首先需要创建一个授权令牌。</p>
<p>登录到您的学生 VM 并确保您位于 <code>wis2box-1.0.0rc1</code> 目录：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
</code></pre></div>
<p>然后使用以下命令登录到 <strong>wis2box-management</strong> 容器：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>在 <strong>wis2box-management</strong> 容器中，您可以使用命令 <code>wis2box auth add-token --path &lt;my-endpoint&gt;</code> 为特定端点创建授权令牌。</p>
<p>例如，为 <code>collections/stations</code> 端点使用一个随机自动生成的令牌：</p>
<div class="highlight"><pre><span></span><code>wis2box auth add-token --path collections/stations
</code></pre></div>
<p>输出将如下所示：</p>
<div class="highlight"><pre><span></span><code>Continue with token: 7ca20386a131f0de384e6ffa288eb1ae385364b3694e47e3b451598c82e899d1 [y/N]? y
Token successfully created
</code></pre></div>
<p>或者，如果您想为 <code>collections/stations</code> 端点定义自己的令牌，可以使用以下示例：</p>
<div class="highlight"><pre><span></span><code>wis2box auth add-token --path collections/stations DataIsMagic
</code></pre></div>
<p>输出：</p>
<div class="highlight"><pre><span></span><code>Continue with token: DataIsMagic [y/N]? y
Token successfully created
</code></pre></div>
<p>请按照上述说明为 <code>collections/stations</code> 端点创建一个授权令牌。</p>
<h2 id="zh-practical-sessions-configuring-station-metadata-wis2box-webapp">使用 <strong>wis2box-webapp</strong> 添加站点元数据</h2>
<p><strong>wis2box-webapp</strong> 提供了一个图形用户界面来编辑站点元数据。</p>
<p>通过在浏览器中导航到 <code>http://&lt;your-host&gt;/wis2box-webapp</code> 打开 <strong>wis2box-webapp</strong>：</p>
<p><img alt="wis2box-webapp" src="../zh/assets/img/wis2box-webapp.png" width="800"></p>
<p>并选择站点：</p>
<p><img alt="wis2box-webapp-select-stations" src="../zh/assets/img/wis2box-webapp-select-stations.png" width="250"></p>
<p>当您点击“添加新站点”时，您需要提供要添加的站点的 WIGOS 站点标识符：</p>
<p><img alt="wis2box-webapp-import-station-from-oscar" src="../zh/assets/img/wis2box-webapp-import-station-from-oscar.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">为 3 个或更多站点添加站点元数据</p>
<p>请向您的 wis2box 站点元数据集合中添加三个或更多站点。</p>
<p>如果可能，请使用您国家的站点，特别是如果您带来了自己的数据。</p>
<p>如果您的国家在 OSCAR/Surface 中没有任何站点，您可以使用以下站点进行此练习：</p>
<ul>
<li>0-20000-0-91334</li>
<li>0-20000-0-96323（注意 OSCAR 中缺少站点高程）</li>
<li>0-20000-0-96749（注意 OSCAR 中缺少站点高程）</li>
</ul>
</div>
<p>当您点击搜索时，站点数据将从 OSCAR/Surface 检索，请注意这可能需要几秒钟。</p>
<p>检查 OSCAR/Surface 返回的数据并在需要时添加缺失数据。选择一个站点主题，并为 <code>collections/stations</code> 端点提供您的授权令牌，然后点击“保存”：</p>
<p><img alt="wis2box-webapp-create-station-save" src="../zh/assets/img/wis2box-webapp-create-station-save.png" width="800"></p>
<p><img alt="wis2box-webapp-create-station-success" src="../zh/assets/img/wis2box-webapp-create-station-success.png" width="500"></p>
<p>返回站点列表，您将看到您添加的站点：</p>
<p><img alt="wis2box-webapp-stations-with-one-station" src="../zh/assets/img/wis2box-webapp-stations-with-one-station.png" width="800"></p>
<p>重复此过程，直到您配置了至少 3 个站点。</p>
<div class="admonition tip">
<p class="admonition-title">推导缺失的高程信息</p>
<p>如果您的站点高程缺失，有在线服务可以帮助使用开放高程数据查找高程。其中一个例子是 <a href="https://www.opentopodata.org">Open Topo Data API</a>。</p>
<p>例如，要获取纬度 -6.15558 和经度 106.84204 的高程，您可以在新的浏览器标签页中复制粘贴以下 URL：</p>
<div class="highlight"><pre><span></span><code>https://api.opentopodata.org/v1/aster30m?locations=-6.15558,106.84204
</code></pre></div>
<p>输出：</p>
<div class="highlight"><pre><span></span><code>{
  &quot;results&quot;: [
    {
      &quot;dataset&quot;: &quot;aster30m&quot;, 
      &quot;elevation&quot;: 7.0, 
      &quot;location&quot;: {
        &quot;lat&quot;: -6.15558, 
        &quot;lng&quot;: 106.84204
      }
    }
  ], 
  &quot;status&quot;: &quot;OK&quot;
}
</code></pre></div>
</div>
<h2 id="zh-practical-sessions-configuring-station-metadata-_3">审查您的站点元数据</h2>
<p>站点元数据存储在 wis2box 的后端，并通过 <strong>wis2box-api</strong> 提供。</p>
<p>如果您打开浏览器并导航到 <code>http://&lt;your-host&gt;/oapi/collections/stations/items</code>，您将看到您添加的站点元数据：</p>
<p><img alt="wis2box-api-stations" src="../zh/assets/img/wis2box-api-stations.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">审查您的站点元数据</p>
<p>通过访问浏览器中的 <code>http://&lt;your-host&gt;/oapi/collections/stations/items</code> 验证您添加的站点是否与您的数据集关联。</p>
</div>
<p>您还可以在 <strong>wis2box-webapp</strong> 中查看/更新/删除站点。请注意，您需要为 <code>collections/stations</code> 端点提供您的授权令牌以更新/删除站点。</p>
<div class="admonition note">
<p class="admonition-title">更新/删除站点元数据</p>
<p>尝试使用 <strong>wis2box-webapp</strong> 更新/删除您添加的一个站点的站点元数据。</p>
</div>
<h2 id="zh-practical-sessions-configuring-station-metadata-_4">批量上传站点元数据</h2>
<p>请注意，wis2box 还能够使用 <strong>wis2box-management</strong> 容器中的命令行从 CSV 文件执行站点元数据的“批量”加载。</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
wis2box<span class="w"> </span>metadata<span class="w"> </span>station<span class="w"> </span>publish-collection<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/metadata/station/station_list.csv<span class="w"> </span>-th<span class="w"> </span>origin/a/wis2/centre-id/weather/surface-based-observations/synop
</code></pre></div>
<p>这允许您一次上传大量站点并将它们与特定主题关联。</p>
<p>您可以使用 Excel 或文本编辑器创建 CSV 文件，然后将其上传到 wis2box-host-datadir 以使其在 <code>/data/wis2box/</code> 目录中的 <strong>wis2box-management</strong> 容器中可用。</p>
<p>在进行大量站点上传后，建议在 <strong>wis2box-webapp</strong> 中审查站点以确保数据正确上传。</p>
<p>有关如何使用此功能的更多信息，请参阅官方 <a href="https://docs.wis2box.wis.wmo.int">wis2box 文档</a>。</p>
<h2 id="zh-practical-sessions-configuring-station-metadata-_5">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了：</p>
<ul>
<li>为 <code>collections/stations</code> 端点创建授权令牌以用于 <strong>wis2box-webapp</strong></li>
<li>使用 <strong>wis2box-webapp</strong> 向 wis2box 添加站点元数据</li>
<li>使用 <strong>wis2box-webapp</strong> 查看/更新/删除站点元数据</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-monitoring-wis2-notifications" heading-number="2.6"><h1 id="zh-practical-sessions-monitoring-wis2-notifications-wis2">监控 WIS2 通知</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>通过本实践课程，您将能够：</p>
<ul>
<li>通过使用 <code>wis2box data ingest</code> 命令在 MinIO 中上传数据来触发 wis2box 工作流</li>
<li>查看 Grafana 仪表板中显示的警告和错误</li>
<li>检查正在发布的数据内容</li>
</ul>
</div>
<h2 id="zh-practical-sessions-monitoring-wis2-notifications-_1">引言</h2>
<p><strong>Grafana 仪表板</strong> 使用来自 Prometheus 和 Loki 的数据来显示您的 wis2box 的状态。Prometheus 存储从收集的指标中获得的时间序列数据，而 Loki 存储在您的 wis2box 实例上运行的容器的日志。这些数据允许您检查 MinIO 上接收到的数据量、发布了多少 WIS2 通知，以及日志中是否检测到任何错误。</p>
<p>要查看在您的 wis2box 的不同主题上发布的 WIS2 通知的内容，您可以使用 <strong>wis2box-webapp</strong> 中的 'Monitor' 标签。</p>
<h2 id="zh-practical-sessions-monitoring-wis2-notifications-_2">准备</h2>
<p>本节将使用之前在 <a href="#practical-sessions-configuring-wis2box-datasets">配置 wis2box 数据集</a> 实践课程中创建的 "surface-based-observations/synop" 数据集。</p>
<p>使用 SSH 客户端（PuTTY 或其他）登录到您的学生 VM。</p>
<p>确保 wis2box 正在运行：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1/
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<p>确保您的 MQTT Explorer 正在运行并使用公共凭据 <code>everyone/everyone</code> 连接到您的实例，并订阅主题 <code>origin/a/wis2/#</code>。</p>
<p>确保您可以通过访问 <code>http://&lt;your-host&gt;:9000</code> 并登录（使用您的 <code>wis2box.env</code> 文件中的 <code>WIS2BOX_STORAGE_USERNAME</code> 和 <code>WIS2BOX_STORAGE_PASSWORD</code>）来访问 MinIO 网页界面。</p>
<p>确保您的网页浏览器已打开并显示您实例的 Grafana 仪表板，通过访问 <code>http://&lt;your-host&gt;:3000</code>。</p>
<h2 id="zh-practical-sessions-monitoring-wis2-notifications-_3">导入一些数据</h2>
<p>请从您的 SSH 客户端会话执行以下命令：</p>
<p>将样本数据文件 <code>aws-example.csv</code> 复制到您在 <code>wis2box.env</code> 文件中定义的 <code>WI2BOX_HOST_DATADIR</code> 目录中。</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>~/exercise-materials/monitoring-exercises/aws-example.csv<span class="w"> </span>~/wis2box-data/
</code></pre></div>
<p>确保您位于 <code>wis2box-1.0.0rc1</code> 目录中并登录到 <strong>wis2box-management</strong> 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>验证样本数据是否可在 <strong>wis2box-management</strong> 容器内的 <code>/data/wis2box/</code> 目录中找到：</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-lh<span class="w"> </span>/data/wis2box/aws-example.csv
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>WIS2BOX_HOST_DATADIR</code> 在 <code>wis2box-management</code> 容器中被挂载为 <code>/data/wis2box/</code>，通过 <code>wis2box-1.0.0rc1</code> 目录中包含的 <code>docker-compose.yml</code> 文件。</p>
<p>这允许您在主机和容器之间共享数据。</p>
</div>
<div class="admonition question">
<p class="admonition-title">练习 1: 使用 <code>wis2box data ingest</code> 导入数据</p>
<p>执行以下命令将样本数据文件 <code>aws-example.csv</code> 导入到您的 wis2box 实例：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/aws-example.csv<span class="w"> </span>--metadata-id<span class="w"> </span>urn:wmo:md:not-my-centre:core.surface-based-observations.synop
</code></pre></div>
<p>数据是否成功导入？如果没有，错误消息是什么，您应该如何解决？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>您将看到以下输出：</p>
<div class="highlight"><pre><span></span><code>Error:<span class="w"> </span><span class="nv">metadata_id</span><span class="o">=</span>urn:wmo:md:not-my-centre:core.surface-based-observations.synop<span class="w"> </span>not<span class="w"> </span>found<span class="w"> </span><span class="k">in</span><span class="w"> </span>data<span class="w"> </span>mappings
</code></pre></div>
<p>错误消息表明您提供的元数据标识符与您的 wis2box 实例中配置的任何数据集都不匹配。</p>
<p>提供与您在上一个实践课程中创建的数据集匹配的正确元数据标识符，并重复数据导入命令，直到您看到以下输出：</p>
<div class="highlight"><pre><span></span><code>Processing<span class="w"> </span>/data/wis2box/aws-example.csv
Done
</code></pre></div>
</details>
<p>转到您的浏览器中的 MinIO 控制台并检查 <code>aws-example.csv</code> 文件是否已上传到 <code>wis2box-incoming</code> 存储桶。您应该看到一个以您在 <code>--metadata-id</code> 选项中提供的数据集名称命名的新目录：</p>
<p><img alt="minio-wis2box-incoming-dataset-folder" src="../zh/assets/img/minio-wis2box-incoming-dataset-folder.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>wis2box data ingest</code> 命令将文件上传到 MinIO 中名为您提供的元数据标识符的 <code>wis2box-incoming</code> 存储桶中的目录。</p>
</div>
<p>转到您的浏览器中的 Grafana 仪表板并检查数据导入的状态。</p>
<div class="admonition question">
<p class="admonition-title">练习 2: 检查数据导入的状态</p>
<p>转到您的浏览器中的 Grafana 仪表板并检查数据导入的状态。</p>
<p>数据是否成功导入？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>Grafana 主页仪表板底部的面板报告以下警告：    </p>
<p><code>WARNING - input=aws-example.csv warning=Station 0-20000-0-60355 not in station list; skipping</code>
<code>WARNING - input=aws-example.csv warning=Station 0-20000-0-60360 not in station list; skipping</code></p>
<p>此警告表明这些站点未在您的 wis2box 的站点列表中定义。在您将其添加到站点列表并将其与您的数据集的主题关联之前，不会为此站点发布任何 WIS2 通知。</p>
</details>
<div class="admonition question">
<p class="admonition-title">练习 3: 添加测试站点并重复数据导入</p>
<p>使用 <strong>wis2box-webapp</strong> 中的站点编辑器添加站点到您的 wis2box，并将站点与您的数据集的主题关联。</p>
<p>现在重新上传样本数据文件 <code>aws-example.csv</code> 到您在上一个练习中使用的 MinIO 中的相同路径。</p>
<p>检查 Grafana 仪表板，有没有新的错误或警告？您如何知道测试数据已成功导入并发布？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>您可以检查 Grafana 主页仪表板上的图表，看看测试数据是否已成功导入并发布。</p>
<p>如果成功，您应该看到以下内容：</p>
<p><img alt="grafana_success" src="../zh/assets/img/grafana_success.png" width="800"></p>
</details>
<div class="admonition question">
<p class="admonition-title">练习 4: 检查 MQTT 代理以获取 WIS2 通知</p>
<p>转到 MQTT Explorer 并检查您是否可以看到您刚刚导入的数据的 WIS2 通知消息。</p>
<p>您的 wis2box 发布了多少条 WIS2 数据通知？</p>
<p>您如何访问正在发布的数据内容？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>您应该看到您的 wis2box 发布了 6 条 WIS2 数据通知。</p>
<p>要访问正在发布的数据内容，您可以展开主题结构以查看消息的不同级别，直到您到达最后一级并查看其中一条消息的消息内容。</p>
<p>消息内容中有一个 "links" 部分，其中包含 "rel" 键为 "canonical" 和 "href" 键，带有下载数据的 URL。URL 的格式为 <code>http://&lt;your-host&gt;/data/...</code>。</p>
<p>请注意，数据格式为 BUFR，您将需要一个 BUFR 解析器来查看数据内容。BUFR 格式是气象服务用来交换数据的二进制格式。wis2box 内的数据插件在发布之前将数据从 CSV 转换为 BUFR。</p>
</details>
<h2 id="zh-practical-sessions-monitoring-wis2-notifications-_4">查看您已发布的数据内容</h2>
<p>您可以使用 <strong>wis2box-webapp</strong> 查看您的 wis2box 发布的 WIS2 数据通知的内容。</p>
<p>通过在浏览器中导航到 <code>http://&lt;your-host&gt;/wis2box-webapp</code> 并选择 <strong>Monitoring</strong> 标签来打开 <strong>wis2box-webapp</strong>：</p>
<p><img alt="wis2box-webapp-monitor" src="../zh/assets/img/wis2box-webapp-monitor.png" width="220"></p>
<p>在监控标签中选择您的数据集 ID 并点击 "UPDATE"</p>
<details class="question">
<summary>练习 5: 在 wis2box-webapp 中查看 WIS2 通知</summary>
<p>您的 wis2box 发布了多少条 WIS2 数据通知？</p>
<p>在 WIGOS 标识符为 0-20000-0-60355 的站点中，最后一条通知中报告的气温是多少？</p>
</details>
<details class="success">
<summary>点击查看答案</summary>
<p>如果您已成功导入测试数据，您应该看到您的 wis2box 发布了 6 条 WIS2 数据通知。</p>
<p>要查看 WIGOS 标识符为 0-20000-0-60355 的站点测量的气温，请点击该站点文件旁边的 "INSPECT" 按钮，打开一个弹出窗口显示数据文件的解析内容。此站点测量的气温为 25.0 摄氏度。</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>wis2box-api 容器包括解析 BUFR 文件并以人类可读格式显示内容的工具。这不是 WIS2.0 实施的核心要求，但已包含在 wis2box 中，以帮助数据发布者检查他们正在发布的数据内容。</p>
</div>
<h2 id="zh-practical-sessions-monitoring-wis2-notifications-_5">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在本实践课程中，您学会了如何：</p>
<ul>
<li>通过在 MinIO 中上传数据使用 <code>wis2box data ingest</code> 命令触发 wis2box 工作流</li>
<li>在 Grafana 仪表板和 MQTT Explorer 中查看您的 wis2box 发布的 WIS2 通知</li>
<li>使用 <strong>wis2box-webapp</strong> 检查正在发布的数据内容</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-converting-synop-data-to-bufr" heading-number="2.7"><h1 id="zh-practical-sessions-converting-synop-data-to-bufr-synopbufr">从命令行将SYNOP数据转换为BUFR</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>使用synop2bufr工具将FM-12 SYNOP报告转换为BUFR；</li>
<li>在格式转换之前诊断并修复FM-12 SYNOP报告中的简单编码错误；</li>
</ul>
</div>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-_1">引言</h2>
<p>陆地表面站的地面天气报告历来每小时或在主要（00、06、12和18 UTC）和中间（03、09、15、21 UTC）天气时报告。在迁移到BUFR之前，这些报告是以纯文本FM-12 SYNOP代码形式编码的。尽管计划在2012年之前完成迁移到BUFR，但仍有大量报告以遗留的FM-12 SYNOP格式交换。有关FM-12 SYNOP格式的更多信息，请参阅WMO代码手册，第I.1卷（WMO-No. 306，第I.1卷）。</p>
<p><a href="https://library.wmo.int/records/item/35713-manual-on-codes-international-codes-volume-i-1">WMO代码手册，第I.1卷</a></p>
<p>为了帮助完成迁移到BUFR，已经开发了一些工具用于将FM-12 SYNOP报告编码为BUFR，在本课程中您将学习如何使用这些工具以及FM-12 SYNOP报告中包含的信息与BUFR消息之间的关系。</p>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-_2">准备工作</h2>
<div class="admonition warning">
<p class="admonition-title">先决条件</p>
<ul>
<li>确保您的wis2box已配置并启动。</li>
<li>通过访问wis2box API（<code>http://&lt;your-host-name&gt;/oapi</code>）并验证API正在运行来确认状态。</li>
<li>在开始练习之前，请确保阅读<strong>synop2bufr入门</strong>和<strong>ecCodes入门</strong>部分。</li>
</ul>
</div>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-synop2bufr">synop2bufr入门</h2>
<p>以下是基本的<code>synop2bufr</code>命令和配置：</p>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-_3">转换</h3>
<p><code>transform</code>功能将SYNOP消息转换为BUFR：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>my_file.csv<span class="w"> </span>--output-dir<span class="w"> </span>./my_directory<span class="w"> </span>--year<span class="w"> </span>message_year<span class="w"> </span>--month<span class="w"> </span>message_month<span class="w"> </span>my_SYNOP.txt
</code></pre></div>
<p>请注意，如果未指定元数据、输出目录、年份和月份选项，它们将采用其默认值：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>--metadata</td>
<td>station_list.csv</td>
</tr>
<tr>
<td>--output-dir</td>
<td>当前工作目录。</td>
</tr>
<tr>
<td>--year</td>
<td>当前年份。</td>
</tr>
<tr>
<td>--month</td>
<td>当前月份。</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用默认的年份和月份时必须小心，因为报告中指定的日期可能不对应（例如，六月没有31天）。</p>
</div>
<p>在示例中，没有给出年份和月份，所以可以自行指定日期或使用默认值。</p>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-eccodes">ecCodes入门</h2>
<p>ecCodes提供了命令行工具，也可以嵌入到您自己的应用程序中。以下是一些与BUFR数据一起使用的有用命令行工具。</p>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-bufr_dump">bufr_dump</h3>
<p><code>bufr_dump</code>命令是一个通用的BUFR信息工具。它有许多选项，但以下将是最适用于练习的：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4
</code></pre></div>
<p>这将显示BUFR内容到您的屏幕上。如果您对特定变量的值感兴趣，请使用<code>egrep</code>命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span>temperature
</code></pre></div>
<p>这将显示您BUFR数据中与温度相关的变量。如果您想对多种类型的变量进行此操作，请使用管道(<code>|</code>)过滤输出：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature|wind&#39;</span>
</code></pre></div>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-synop2bufrfm-12-synopbufr">从命令行使用synop2bufr将FM-12 SYNOP转换为BUFR</h2>
<p>eccodes库和synop2bufr模块已安装在wis2box-api容器中。为了进行接下来的几个练习，我们将synop2bufr-exercises目录复制到wis2box-api容器中并从那里运行练习：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>~/exercise-materials/synop2bufr-exercises<span class="w"> </span>wis2box-api:/root
</code></pre></div>
<p>现在我们可以进入容器并运行练习：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>wis2box-api<span class="w"> </span>/bin/bash
</code></pre></div>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-1">练习1</h3>
<p>导航到<code>/root/synop2bufr-exercises/ex_1</code>目录并检查SYNOP消息文件message.txt：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/synop2bufr-exercises/ex_1
more<span class="w"> </span>message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>这个文件中有多少个SYNOP报告？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>有1个SYNOP报告，因为在消息的结尾只有1个分隔符(=)。</p>
</details>
<p>检查站点列表：</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>站点列表中列出了多少个站点？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>有1个站点，station_list.csv包含一行站点元数据。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>尝试将<code>message.txt</code>转换为BUFR格式。</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要将SYNOP消息转换为BUFR格式，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>message.txt
</code></pre></div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>请参阅<a href="#zh-practical-sessions-converting-synop-data-to-bufr-synop2bufr入门">synop2bufr入门</a>部分。</p>
</div>
<p>使用<code>bufr_dump</code>检查生成的BUFR数据。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>如何比较纬度和经度值与站点列表中的值？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要比较BUFR数据中的纬度和经度值与站点列表中的值，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15015_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;latitude|longitude&#39;</span>
</code></pre></div>
<p>这将显示BUFR数据中的纬度和经度值。</p>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>请参阅<a href="#zh-practical-sessions-converting-synop-data-to-bufr-eccodes入门">ecCodes入门</a>部分。</p>
</div>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-2">练习2</h3>
<p>导航到<code>exercise-materials/synop2bufr-exercises/ex_2</code>目录并检查SYNOP消息文件message.txt：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/synop2bufr-exercises/ex_2
more<span class="w"> </span>message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>这个文件中有多少个SYNOP报告？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>有3个SYNOP报告，因为在消息的结尾有3个分隔符(=)。</p>
</details>
<p>检查站点列表：</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>站点列表中列出了多少个站点？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>有3个站点，station_list.csv包含三行站点元数据。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>将<code>message.txt</code>转换为BUFR格式。</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要将SYNOP消息转换为BUFR格式，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>message.txt
</code></pre></div>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>根据这个和上一个练习的结果，您如何预测基于SYNOP报告数量和站点元数据文件中列出的站点数量的结果BUFR文件数量？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要查看生成的BUFR文件，请运行以下命令：</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>*.bufr4
</code></pre></div>
<p>生成的BUFR文件数量将等于消息文件中的SYNOP报告数量。</p>
</details>
<p>使用<code>bufr_dump</code>检查生成的BUFR数据。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>如何检查每个生成的文件中编码的WIGOS站点ID？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>这可以通过以下命令完成：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15015_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15020_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15090_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
<p>注意，如果您的目录中只有这3个BUFR文件，您可以使用Linux通配符如下：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>*.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
</details>
<hzh-practical-sessions-converting-synop-data-to-bufr-3 id="zh-practical-sessions-converting-synop-data-to-bufr-3">练习3</h3>
<p>导航到<code>exercise-materials/synop2bufr-exercises/ex_3</code>目录并检查SYNOP消息文件message.txt：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/synop2bufr-exercises/ex_3
more<span class="w"> </span>message.txt
</code></pre></div>
<p>这个SYNOP消息只包含一个更长的报告，有更多的部分。</p>
<p>检查站点列表：</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>这个文件包含的站点比SYNOP消息中的报告多，这有问题吗？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>没有问题，只要站点列表文件中存在与我们试图转换的SYNOP报告匹配的站点TSI的行。</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>站点列表文件是<code>synop2bufr</code>的元数据来源，为在BUFR SYNOP中提供字母数字SYNOP报告中缺失的信息。</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>将<code>message.txt</code>转换为BUFR格式。</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>这是使用<code>transform</code>命令完成的，例如：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>message.txt
</code></pre></div>
</details>
<p>使用<code>bufr_dump</code>检查生成的BUFR数据。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>查找以下变量：</p>
<ul>
<li>报告的空气温度（K）</li>
<li>报告的总云量（%）</li>
<li>报告的总日照时长（分钟）</li>
<li>报告的风速（m/s）</li>
</ul>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要通过关键字在BUFR数据中查找变量，您可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15260_20240921T115500.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature&#39;</span>
</code></pre></div>
<p>您可以使用以下命令搜索多个关键字：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15260_20240921T115500.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature|cover|sunshine|wind&#39;</span>
</code></pre></div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>您可能会发现<a href="#zh-practical-sessions-converting-synop-data-to-bufr-eccodes入门">ecCodes入门</a>部分的最后一个命令很有用。</p>
</div>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-4">练习4</h3>
<p>导航到<code>exercise-materials/synop2bufr-exercises/ex_4</code>目录并检查SYNOP消息文件message.txt：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/synop2bufr-exercises/ex_4
more<span class="w"> </span>message_incorrect.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>这个SYNOP文件有什么不正确的地方？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>15015的SYNOP报告缺少允许<code>synop2bufr</code>区分此报告与下一个报告的分隔符(<code>=</code>)。</p>
</details>
<p>尝试使用<code>station_list.csv</code>转换<code>message_incorrect.txt</code></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>您在这次转换中遇到了什么问题？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要将SYNOP消息转换为BUFR格式，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>message_incorrect.txt
</code></pre></div>
<p>尝试转换应该会引发以下错误：</p>
<ul>
<li><code>[ERROR] 无法解码SYNOP消息</code></li>
<li><code>[ERROR] 解析SYNOP报告时出错：AAXX 21121 15015 02999 02501 10103 21090 39765 42952 57020 60001 15020 02997 23104 10130 21075 30177 40377 58020 60001 81041. 10130不是有效的组！</code></li>
</ul>
</details>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-5">练习5</h3>
<p>导航到<code>exercise-materials/synop2bufr-exercises/ex_5</code>目录并检查SYNOP消息文件message.txt：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/synop2bufr-exercises/ex_5
more<span class="w"> </span>message.txt
</code></pre></div>
<p>尝试使用<code>station_list_incorrect.csv</code>将<code>message.txt</code>转换为BUFR格式</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>您在这次转换中遇到了什么问题？<br />
考虑到呈现的错误，证明生成的BUFR文件数量。</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要将SYNOP消息转换为BUFR格式，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list_incorrect.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>message.txt
</code></pre></div>
<p>一个站点TSI（<code>15015</code>）在站点列表中没有相应的元数据，这将阻止synop2bufr访问将第一个SYNOP报告转换为BUFR所需的额外必要元数据。</p>
<p>您将看到以下警告：</p>
<ul>
<li><code>[WARNING] 站点15015在站点文件中未找到</code></li>
</ul>
<p>您可以通过运行以下命令查看生成的BUFR文件数量：</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>*.bufr4
</code></pre></div>
<p>message.txt中有3个SYNOP报告，但只生成了2个BUFR文件。这是因为上面提到的一个SYNOP报告缺乏必要的元数据。</p>
</details>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-_4">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学习了：</p>
<ul>
<li>如何使用synop2bufr工具将FM-12 SYNOP报告转换为BUFR；</li>
<li>如何在格式转换之前诊断并修复FM-12 SYNOP报告中的简单编码错误；</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-converting-synop-data-to-bufr-form" heading-number="2.8"><h1 id="zh-practical-sessions-converting-synop-data-to-bufr-form-wis2box-webappsynopbufr">使用wis2box-webapp将SYNOP数据转换为BUFR</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>通过wis2box网络应用程序提交有效的FM-12 SYNOP公告，以转换为BUFR并通过WIS2.0交换</li>
<li>在格式转换和交换之前，验证、诊断并修复FM-12 SYNOP公告中的简单编码错误</li>
<li>确保所需的站点元数据在wis2box中可用</li>
<li>确认并检查成功转换的公告</li>
</ul>
</div>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-form-_1">引言</h2>
<p>为了允许手动观察者直接向WIS2.0提交数据，wis2box-webapp有一个表单用于将FM-12 SYNOP公告转换为BUFR。该表单还允许用户在格式转换和交换之前诊断并修复FM-12 SYNOP公告中的简单编码错误，并检查生成的BUFR数据。</p>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-form-_2">准备工作</h2>
<div class="admonition warning">
<p class="admonition-title">先决条件</p>
<ul>
<li>确保您的wis2box已配置并启动。</li>
<li>打开终端并使用SSH连接到您的学生VM。</li>
<li>使用MQTT Explorer连接到您的wis2box实例的MQTT代理。</li>
<li>打开wis2box网络应用程序（<code>http://&lt;your-host-name&gt;/wis2box-webapp</code>）并确保您已登录。</li>
</ul>
</div>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-form-wis2box-webappfm-12-synopbufr">使用wis2box-webapp将FM-12 SYNOP转换为BUFR</h2>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-form-1-wis2box-webappfm-12-synopbufr">练习1 - 使用wis2box-webapp将FM-12 SYNOP转换为BUFR</h3>
<p>确保您拥有在上一个练习中生成的“processes/wis2box”的授权令牌，并且您已连接到MQTT Explorer中的wis2box代理。</p>
<p>复制以下消息：</p>
<div class="highlight"><pre><span></span><code>AAXX 27031
15015 02999 02501 10103 21090 39765 42952 57020 60001=
</code></pre></div>
<p>打开wis2box网络应用程序，使用左侧导航抽屉导航到synop2bufr页面，然后按照以下步骤操作：</p>
<ul>
<li>将您复制的内容粘贴到文本输入框中。</li>
<li>使用日期选择器选择月份和年份，假设本练习为当前月份。</li>
<li>从下拉菜单中选择一个主题（选项基于wis2box中配置的数据集）。</li>
<li>输入您之前生成的“processes/wis2box”授权令牌</li>
<li>确保“在WIS2上发布”已开启</li>
<li>点击“提交”</li>
</ul>
<p><center><img alt="显示synop2bufr页面的对话框，包括切换按钮" src="../zh/assets/img/synop2bufr-toggle.png"></center></p>
<p>点击提交。您将收到一个警告消息，因为站点未在wis2box中注册。转到station-editor并导入以下站点：</p>
<div class="highlight"><pre><span></span><code>0-20000-0-15015
</code></pre></div>
<p>确保站点与您在上一步中选择的主题相关联，然后返回到synop2bufr页面并重复之前的过程。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>您如何查看从FM-12 SYNOP到BUFR的转换结果？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>页面的结果部分显示警告、错误和输出BUFR文件。</p>
<p>点击“输出BUFR文件”以查看已生成的文件列表。您应该看到一个文件列表。</p>
<p>下载按钮允许将BUFR数据直接下载到您的计算机。</p>
<p>检查按钮运行一个过程来转换和提取BUFR中的数据。</p>
<p><center><img alt="显示成功提交消息的对话框"
     src="../zh/assets/img/synop2bufr-ex2-success.png"></center></p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>FM-12 SYNOP输入数据未包括站点位置、海拔或气压计高度。
确认这些是否在输出BUFR数据中，这些数据从何而来？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>点击检查按钮应显示如下所示的对话框。</p>
<p><center><img alt="检查按钮结果显示基本站点元数据、站点位置和观测属性"
     src="../zh/assets/img/synop2bufr-ex2.png"></center></p>
<p>这包括在地图上显示的站点位置和基本元数据，以及消息中的观测结果。</p>
<p>作为从FM-12 SYNOP到BUFR的转换的一部分，额外的元数据被添加到BUFR文件中。</p>
<p>BUFR文件也可以通过下载文件并使用如ECMWF ecCodes BUFR验证器等工具进行验证。</p>
</details>
<p>转到MQTT Explorer并检查已发布的WIS2通知主题，以查看已发布的WIS2通知。</p>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-form-2-">练习2 - 理解站点列表</h3>
<p>在下一个练习中，您将转换包含多个报告的文件，见下面的数据：</p>
<div class="highlight"><pre><span></span><code>AAXX 27031
15015 02999 02501 10103 21090 39765 42952 57020 60001=
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>根据之前的练习，查看FM-12 SYNOP消息并预测将生成多少个输出BUFR消息。</p>
<p>现在将此消息复制粘贴到SYNOP表单并提交数据。</p>
<p>生成的消息数量是否符合您的预期，如果不符合，为什么？</p>
</div>
<details class="warning">
<summary>点击以显示答案</summary>
<p>您可能预期会生成三个BUFR消息，每个天气报告一个。然而，您实际上得到了2个警告和只有一个BUFR文件。</p>
<p>为了将天气报告转换为BUFR，需要站点列表中包含的基本元数据。尽管上述示例包括三个天气报告，但其中三个站点中的两个未在您的wis2box中注册。</p>
<p>因此，三个天气报告中只有一个结果生成了BUFR文件并发布了WIS2通知。其他两个天气报告被忽略并生成了警告。</p>
</details>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>注意WIGOS标识符与BUFR输出中包含的传统站点标识符之间的关系。在许多情况下，对于在迁移到WIGOS站点标识符时已列在WMO-No. 9第A卷的站点，WIGOS站点标识符由传统站点标识符前加上<code>0-20000-0</code>给出，
例如<code>15015</code>已变为<code>0-20000-0-15015</code>。</p>
</div>
<p>使用站点列表页面，导入以下站点：</p>
<div class="highlight"><pre><span></span><code>0-20000-0-15020
0-20000-0-15090
</code></pre></div>
<p>确保站点与您在上一个练习中选择的主题相关联，然后返回到synop2bufr页面并重复过程。</p>
<p>现在应该生成三个BUFR文件，并且网页应用程序中不应列出任何警告或错误。</p>
<p>除了基本站点信息外，还需要额外的元数据，如站点海拔高度和海平面上的气压计高度，这些字段包含在站点列表和站点编辑器页面中。</p>
<h3 id="zh-practical-sessions-converting-synop-data-to-bufr-form-3-">练习3 - 调试</h3>
<p>在这最后一个练习中，您将识别并纠正在使用此工具将FM-12 SYNOP转换为BUFR时遇到的两个最常见的问题。</p>
<p>下面的框中显示了示例数据，检查数据并尝试在通过网络应用程序提交数据之前解决任何问题。</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>您可以在网页应用程序页面的输入框中编辑数据。如果您遗漏了任何问题，这些应该在点击提交按钮后被检测到并突出显示为警告或错误。</p>
</div>
<div class="highlight"><pre><span></span><code>AAXX 27031
15015 02999 02501 10103 21090 39765 42952 57020 60001
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>在将数据转换为BUFR时，您预期会遇到哪些问题，您是如何克服它们的？有没有您没有预料到的问题？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>在第一个示例中，“文本结束”符号（=），或记录分隔符，在第一和第二个天气报告之间缺失。因此，第2行和第3行被视为单个报告，导致消息解析出错。</p>
</details>
<p>下面的第二个示例包含FM-12 SYNOP报告中发现的几个常见问题。检查数据并尝试识别问题，然后通过网络应用程序提交更正后的数据。</p>
<div class="highlight"><pre><span></span><code>AAXX 27031
15020 02997 23104 10/30 21075 30177 40377 580200 60001 81041=
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>您发现了哪些问题，您是如何解决这些问题的？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>天气报告中有两个问题。</p>
<p>第一个问题出现在带符号的气温组中，十位字符设置为缺失（/），导致组无效。在这个示例中，我们知道温度是13.0摄氏度（从上面的示例中得知），因此可以纠正这个问题。在操作中，正确的值需要与观察者确认。</p>
<p>第二个问题出现在第5组中，有一个额外的字符，最后一个字符重复了。这个问题可以通过移除额外的字符来解决。</p>
</details>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-form-_3">清理</h2>
<p>在本次会议的练习中，您将导入几个文件到您的站点列表中。导航到站点列表页面并点击垃圾桶图标删除站点。您可能需要刷新页面才能在删除后从列表中移除站点。</p>
<p><center><img alt="站点元数据查看器"
         src="../zh/assets/img/synop2bufr-trash.png" width="600"></center></p>
<h2 id="zh-practical-sessions-converting-synop-data-to-bufr-form-_4">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学到了：</p>
<ul>
<li>如何使用synop2bufr工具将FM-12 SYNOP报告转换为BUFR；</li>
<li>如何通过网络应用提交FM-12 SYNOP报告；</li>
<li>如何诊断并纠正FM-12 SYNOP报告中的简单错误；</li>
<li>在wis2box（和OSCAR/Surface）中注册站点的重要性；</li>
<li>如何使用检查按钮查看BUFR数据的内容。</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-converting-csv-data-to-bufr" heading-number="2.9"><h1 id="zh-practical-sessions-converting-csv-data-to-bufr-csv-bufr">将 CSV 数据转换为 BUFR</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>使用 <strong>MinIO UI</strong> 上传输入的 CSV 数据文件并监控结果</li>
<li>了解与默认自动气象站 BUFR 模板一起使用的 CSV 数据格式</li>
<li>在 <strong>wis2box webapp</strong> 中使用数据集编辑器创建用于发布 DAYCLI 消息的数据集</li>
<li>了解与 DAYCLI BUFR 模板一起使用的 CSV 数据格式</li>
<li>使用 <strong>wis2box webapp</strong> 验证并转换 AWS 站点的样本数据为 BUFR（可选）</li>
</ul>
</div>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-_1">引言</h2>
<p>逗号分隔值（CSV）数据文件常用于以表格格式记录观测数据和其他数据。
大多数用于记录传感器输出的数据记录器能够导出观测数据到分隔文件，包括 CSV 文件。
同样，当数据被摄取到数据库中时，很容易以 CSV 格式导出所需的数据。
为了帮助交换原始存储在表格数据格式中的数据，wis2box 实现了 CSV 到 BUFR 的转换，使用的软件与 SYNOP 到 BUFR 相同。</p>
<p>在本课程中，您将学习在 wis2box 中使用 csv2bufr 转换器的以下内置模板：</p>
<ul>
<li><strong>AWS</strong> (aws-template.json)：转换简化自动气象站文件中的 CSV 数据到 BUFR 序列 301150, 307096 的映射模板</li>
<li><strong>DayCLI</strong> (daycli-template.json)：转换日常气候 CSV 数据到 BUFR 序列 307075 的映射模板</li>
</ul>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-_2">准备工作</h2>
<p>确保已使用 <code>python3 wis2box.py start</code> 启动 wis2box-stack。</p>
<p>确保您的浏览器已打开并通过 <code>http://&lt;your-host&gt;:9000</code> 访问您实例的 MinIO UI。
如果您忘记了 MinIO 凭据，可以在学生 VM 上的 <code>wis2box-1.0.0rc1</code> 目录中的 <code>wis2box.env</code> 文件中找到它们。</p>
<p>确保您已打开 MQTT Explorer 并使用凭据 <code>everyone/everyone</code> 连接到您的代理。</p>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-1-aws-csv2bufr">练习 1：使用带有 'AWS' 模板的 csv2bufr</h2>
<p>'AWS' 模板提供了一个预定义的映射模板，用于转换 AWS 站点的 CSV 数据，以支持 GBON 报告要求。</p>
<p>可以在此处找到 AWS 模板的描述：</p>
<p><a href="#csv2bufr-templates-aws-template">aws-template</a></p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-aws-example">审查 aws-example 输入数据</h3>
<p>从下面的链接下载本练习的示例：</p>
<p><a href="/sample-data/aws-example.csv">aws-example.csv</a></p>
<p>打开您下载的文件，并检查内容：</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>检查日期、时间和标识字段（WIGOS 和传统标识符），您注意到了什么？今天的日期应该如何表示？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>每列包含单独的信息。例如，日期被分为年、月和日，反映了数据在 BUFR 中的存储方式。同样，时间需要分为“小时”和“分钟”，WIGOS 站点标识符需要分解为其各自的组成部分。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>查看数据文件，缺失数据是如何编码的？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>文件中的缺失数据由空单元格表示。在 CSV 文件中，这将被编码为 <code>,,</code>。注意，这是一个空单元格，而不是编码为零长度字符串，例如 <code>,"",</code>。</p>
</details>
<div class="admonition hint">
<p class="admonition-title">缺失数据</p>
<p>由于传感器故障或未观测到参数等各种原因，数据可能会缺失。在这些情况下，可以按照上述答案编码缺失数据，报告中的其他数据仍然有效。</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>示例文件中报告数据的站点的 WIGOS 站点标识符是什么？它在输入文件中是如何定义的？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>WIGOS 站点标识符由文件中的 4 个单独列定义：</p>
<ul>
<li><strong>wsi_series</strong>：WIGOS 标识符系列</li>
<li><strong>wsi_issuer</strong>：WIGOS 标识符发行者</li>
<li><strong>wsi_issue_number</strong>：WIGOS 发行编号</li>
<li><strong>wsi_local</strong>：WIGOS 本地标识符</li>
</ul>
<p>示例文件中使用的 WIGOS 站点标识符是 <code>0-20000-0-60351</code>、<code>0-20000-0-60355</code> 和 <code>0-20000-0-60360</code>。</p>
</details>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-_3">更新示例文件</h3>
<p>更新您下载的示例文件，使用今天的日期和时间，并更改 WIGOS 站点标识符以使用您在 wis2box-webapp 中注册的站点。</p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-minio">上传数据到 MinIO 并检查结果</h3>
<p>导航到 MinIO UI 并使用 <code>wis2box.env</code> 文件中的凭据登录。</p>
<p>导航到 <strong>wis2box-incoming</strong> 并点击“创建新路径”按钮：</p>
<p><img alt="显示 MinIO UI 的图像，其中突出显示了创建文件夹按钮" src="../zh/assets/img/minio-create-new-path.png"/></p>
<p>在 MinIO 存储桶中创建一个与您使用 template='weather/surface-weather-observations/synop' 创建的数据集 id 匹配的新文件夹：</p>
<p><img alt="显示 MinIO UI 的图像，其中突出显示了创建文件夹按钮" src="../zh/assets/img/minio-create-new-path-metadata_id.png"/></p>
<p>将您下载的示例文件上传到您在 MinIO 存储桶中创建的文件夹：</p>
<p><img alt="显示 MinIO UI 的图像，其中 aws-example 已上传" src="../zh/assets/img/minio-upload-aws-example.png"/></center></p>
<p>检查 <code>http://&lt;your-host&gt;:3000</code> 的 Grafana 仪表板，查看是否有任何警告或错误。如果看到任何问题，请尝试修复它们并重复练习。</p>
<p>检查 MQTT Explorer，看是否收到 WIS2 数据通知。</p>
<p>如果您成功摄取了数据，您应该在主题 <code>origin/a/wis2/&lt;centre-id&gt;/data/weather/surface-weather-observations/synop</code> 上的 MQTT explorer 中看到 3 个站点的 3 个通知：</p>
<p><img width="450" alt="在上传 AWS 后显示 MQTT explorer 的图像" src="../zh/assets/img/mqtt-explorer-aws-upload.png"/></p>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-2-daycli">练习 2 - 使用 'DayCLI' 模板</h2>
<p>在上一个练习中，我们使用了您创建的数据类型为 'weather/surface-weather-observations/synop' 的数据集，该数据集已预配置了 CSV 到 BUFR 转换模板为 AWS 模板。</p>
<p>在下一个练习中，我们将使用 'DayCLI' 模板将日常气候数据转换为 BUFR。</p>
<p>可以在此处找到 DAYCLI 模板的描述：</p>
<p><a href="#csv2bufr-templates-daycli-template">daycli-template</a></p>
<div class="admonition note">
<p class="admonition-title">关于 DAYCLI 模板</p>
<p>请注意，DAYCLI BUFR 序列将在 2025 年更新，以包括额外的信息和修订的 QC 标志。wis2box 将更新 DAYCLI 模板以反映这些变化。WMO 将通知何时更新 wis2box 软件以包括新的 DAYCLI 模板，以便用户相应更新其系统。</p>
</div>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-daycli-wis2box">创建用于发布 DAYCLI 消息的 wis2box 数据集</h3>
<p>转到 wis2box-webapp 中的数据集编辑器并创建一个新数据集。使用与之前实践课程相同的中心 ID，并选择 <strong>Data Type='climate/surface-based-observations/daily'</strong>：</p>
<p><img alt="在 wis2box-webapp 中为 DAYCLI 创建一个新数据集" src="../zh/assets/img/wis2box-webapp-create-dataset-daycli.png"/></p>
<p>点击“继续到表单”，为您的数据集添加描述，设置边界框并提供数据集的联系信息。填写完所有部分后，点击 'VALIDATE FORM' 并检查表单。</p>
<p>查看数据集的数据插件。点击名称为“CSV 数据转换为 BUFR”的插件旁边的“更新”，您将看到模板设置为 <strong>DayCLI</strong>：</p>
<p><img alt="更新数据集的数据插件以使用 DAYCLI 模板" src="../zh/assets/img/wis2box-webapp-update-data-plugin-daycli.png"/></p>
<p>关闭插件配置并使用您在上一个实践课程中创建的认证令牌提交表单。</p>
<p>您现在应该在 wis2box-webapp 中有第二个配置为使用 DAYCLI 模板将 CSV 数据转换为 BUFR 的数据集。</p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-daycli-example">审查 daycli-example 输入数据</h3>
<p>从下面的链接下载本练习的示例：</p>
<p><a href="/sample-data/daycli-example.csv">daycli-example.csv</a></p>
<p>打开您下载的文件，并检查内容：</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>daycli 模板中包含了哪些额外的变量？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>daycli 模板包括有关仪器放置和温度及湿度测量质量分类的重要元数据、质量控制标志以及如何计算日平均温度的信息。</p>
</details>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-_4">更新示例文件</h3>
<p>示例文件包含一个月中每天的一行数据，并为一个站点报告数据。更新您下载的示例文件，使用今天的日期和时间，并更改 WIGOS 站点标识符以使用您在 wis2box-webapp 中注册的站点。</p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-minio_1">上传数据到 MinIO 并检查结果</h3>
<p>与之前一样，您需要将数据上传到 MinIO 中的 'wis2box-incoming' 存储桶中，以便由 csv2bufr 转换器处理。这次您需要在 MinIO 存储桶中创建一个新文件夹，该文件夹的数据集 ID 与您使用 template='climate/surface-based-observations/daily' 创建的数据集 ID 匹配，这与您在上一个练习中使用的数据集 ID 不同：</p>
<p><img alt="显示 MinIO UI 的图像，其中 DAYCLI-example 已上传" src="../zh/assets/img/minio-upload-daycli-example.png"/></center></p>
<p>上传数据后，在 Grafana 仪表板中检查是否有任何警告或错误，并检查 MQTT Explorer，看是否收到 WIS2 数据通知。</p>
<p>如果您成功摄取了数据，您应该在主题 <code>origin/a/wis2/&lt;centre-id&gt;/data/climate/surface-based-observations/daily</code> 上的 MQTT explorer 中看到您报告的月份中 30 天的 30 个通知：</p>
<p><img width="450" alt="在上传 DAYCLI 后显示 MQTT explorer 的图像" src="../zh/assets/img/mqtt-daycli-template-success.png"/></p>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-3-wis2box-webapp-csv">练习 3 - 使用 wis2box-webapp 中的 CSV 表单（可选）</h2>
<p>wis2box Web 应用程序提供了一个界面，用于上传 CSV 数据并在发布到 WIS2 之前将其转换为 BUFR，使用 AWS 模板。</p>
<p>使用此表单的目的是用于调试和验证，推荐的自动气象站数据发布方法是设置一个自动上传数据到 MinIO 存储桶的过程。</p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-wis2box-web-csv">在 wis2box web 应用程序中使用 CSV 表单</h3>
<p>导航到 wis2box web 应用程序上的 CSV 表单
(<code>http://&lt;your-host-name&gt;/wis2box-webapp/csv2bufr_form</code>)。
在本练习中使用文件 <a href="/sample-data/aws-example.csv">aws-example.csv</a>。
您现在应该能够点击下一步以预览并验证文件。</p>
<p><center><img alt="显示 CSV 到 BUFR 上传屏幕的图像" src="../zh/assets/img/csv2bufr-ex1.png"/></center></p>
<p>点击下一步按钮将文件加载到浏览器并根据预定义的模式验证内容。
数据尚未转换或发布。在预览/验证标签页上，您应该会看到关于缺失数据的警告列表，但在本练习中这些可以忽略。</p>
<p><center><img alt="显示 CSV 到 BUFR 示例验证页面的警告的图像" src="../zh/assets/img/csv2bufr-warnings.png"/></center></p>
<p>点击 <em>next</em> 继续，您将被要求提供数据发布的数据集 ID。选择您之前创建的数据集 ID 并点击 <em>next</em>。</p>
<p>您现在应该在授权页面上，您将被要求输入您之前创建的 <code>processes/wis2box</code> 令牌。输入此令牌并点击 "Publish on WIS2" 开关以确保选择了 "Publish to WIS2"（见下面的屏幕截图）。</p>
<p><center><img alt="csv2bufr 授权和发布屏幕" src="../zh/assets/img/csv2bufr-toggle-publish.png"/></center></p>
<p>点击下一步以转换为 BUFR 并发布，您应该会看到以下屏幕：</p>
<p><center><img alt="显示 CSV 到 BUFR 示例成功屏幕的图像" src="../zh/assets/img/csv2bufr-success.png"/></center></p>
<p>点击右侧的 <code>Output BUFR files</code> 下的向下箭头应该会显示 <code>Download</code> 和 <code>Inspect</code> 按钮。
点击 inspect 查看数据并确认值是否符合预期。</p>
<p><center><img alt="显示 CSV 到 BUFR 检查输出的图像" src="../zh/assets/img/csv2bufr-inspect.png"/></center></p>
<h3 id="zh-practical-sessions-converting-csv-data-to-bufr-_5">调试无效输入数据</h3>
<p>在这个练习中，我们将检查输入无效数据时会发生什么。通过点击下面的链接下载下一个示例文件。这包含与第一个文件相同的数据，但已删除空列。
检查文件并确认已删除哪些列，然后按照相同的过程将数据转换为 BUFR。</p>
<p><a href="/sample-data/csv2bufr-ex3a.csv">csv2bufr-ex3a.csv</a></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>由于文件中缺少列，您是否能够将数据转换为 BUFR？
您是否注意到验证页面上的警告有什么变化？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>您应该仍然能够将数据转换为 BUFR，但警告消息将更新为完全缺少列而不是包含缺失值。</p>
</details>
<p>在下一个示例中，CSV 文件中添加了一个额外的列。</p>
<p><a href="/sample-data/csv2bufr-ex3b.csv">csv2bufr-ex3b.csv</a></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>在上传或提交文件之前，您能预测会发生什么吗？</p>
</div>
<p>现在上传并确认您的预测是否正确。</p>
<details class="success">
<summary>点击以显示答案</summary>
<p>当文件被验证时，您应该会收到一个警告，指出列 <code>index</code> 在模式中未找到，数据将被跳过。您应该能够像之前的示例一样点击并转换为 BUFR。</p>
</details>
<p>在这个练习的最后一个示例中，数据已被修改。检查 CSV 文件的内容。</p>
<p><a href="/sample-data/csv2bufr-ex3c.csv">csv2bufr-ex3c.csv</a></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>文件中发生了什么变化，您认为会发生什么？</p>
</div>
<p>现在上传文件并确认您是否正确。</p>
<details class="warning">
<summary>点击以显示答案</summary>
<p>输入数据中的压力字段已从 Pa 转换为 hPa。然而，CSV 到 BUFR 转换器期望与 BUFR 相同的单位（Pa），结果，这些字段由于超出范围而未通过验证。您应该能够编辑 CSV 以纠正问题，并通过返回第一个屏幕并重新上传数据来重新提交。</p>
</details>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>wis2box web 应用程序可用于测试和验证自动化工作流程的样本数据。这将识别一些常见问题，例如单位不正确（hPa 与 Pa 以及 C 与 K）和缺少列。应注意 CSV 数据中的单位与上述指示的单位相匹配。</p>
</div>
<h2 id="zh-practical-sessions-converting-csv-data-to-bufr-_6">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜</p>
<p>在这个实践课程中，您已经学到了：</p>
<ul>
<li>关</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-automating-data-ingestion" heading-number="2.10"><h1 id="zh-practical-sessions-automating-data-ingestion-_1">自动化数据摄取</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>通过本实践课程，您将能够：</p>
<ul>
<li>理解您的数据集的数据插件如何决定数据摄取工作流</li>
<li>使用 MinIO Python 客户端脚本将数据摄取到 wis2box</li>
<li>通过 SFTP 访问 MinIO 将数据摄取到 wis2box</li>
</ul>
</div>
<h2 id="zh-practical-sessions-automating-data-ingestion-_2">引言</h2>
<p><strong>wis2box-management</strong> 容器监听来自 MinIO 存储服务的事件，根据为您的数据集配置的数据插件触发数据摄取。这允许您将数据上传到 MinIO 存储桶，并触发 wis2box 工作流以在 WIS2 代理上发布数据。</p>
<p>数据插件定义了由 <strong>wis2box-management</strong> 容器加载的 Python 模块，并确定如何转换和发布数据。</p>
<p>在上一个练习中，您应该使用模板 <code>surface-based-observations/synop</code> 创建了一个数据集，其中包括以下数据插件：</p>
<p><img alt="数据映射" src="../zh/assets/img/wis2box-data-mappings.png" width="800"></p>
<p>当文件被上传到 MinIO 时，wis2box 将根据文件路径包含的数据集 id (<code>metadata_id</code>) 匹配文件到一个数据集，并根据在数据集映射中定义的文件扩展名和文件模式确定使用哪些数据插件。</p>
<p>在之前的课程中，我们通过使用 wis2box 命令行功能触发了数据摄取工作流，该功能将数据上传到正确路径的 MinIO 存储中。</p>
<p>同样的步骤可以通过使用任何 MinIO 或 S3 客户端软件以编程方式完成，允许您将数据摄取自动化为您的运营工作流的一部分。</p>
<p>或者，您也可以使用 SFTP 协议访问 MinIO 上传数据并触发数据摄取工作流。</p>
<h2 id="zh-practical-sessions-automating-data-ingestion-_3">准备工作</h2>
<p>使用您的 SSH 客户端（PuTTY 或其他）登录到您的学生 VM。</p>
<p>确保 wis2box 正在运行：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1/
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<p>确保 MQTT Explorer 正在运行并连接到您的实例。如果您仍然从上一次会话连接，清除您可能从队列收到的任何先前消息。
这可以通过断开连接并重新连接或点击给定主题的垃圾桶图标来完成。</p>
<p>确保您的 Web 浏览器打开了您实例的 Grafana 仪表板，通过访问 <code>http://&lt;your-host&gt;:3000</code></p>
<p>同时确保您打开了第二个标签页，其中显示了 MinIO 用户界面 <code>http://&lt;your-host&gt;:9001</code>。记住您需要使用在 <code>wis2box.env</code> 文件中定义的 <code>WIS2BOX_STORAGE_USER</code> 和 <code>WIS2BOX_STORAGE_PASSWORD</code> 登录。</p>
<h2 id="zh-practical-sessions-automating-data-ingestion-1-python-minio">练习 1：设置 Python 脚本将数据摄取到 MinIO</h2>
<p>在这个练习中，我们将使用 MinIO Python 客户端将数据复制到 MinIO。</p>
<p>MinIO 提供了一个 Python 客户端，可以按如下方式安装：</p>
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>minio
</code></pre></div>
<p>在您的学生 VM 上，Python 的 'minio' 包已经安装好了。</p>
<p>转到目录 <code>exercise-materials/data-ingest-exercises</code>；这个目录包含一个使用 MinIO Python 客户端将文件复制到 MinIO 的示例脚本 <code>copy_file_to_incoming.py</code>。</p>
<p>尝试运行脚本将样本数据文件 <code>csv-aws-example.csv</code> 复制到 MinIO 的 <code>wis2box-incoming</code> 存储桶中，如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/data-ingest-exercises
python3<span class="w"> </span>copy_file_to_incoming.py<span class="w"> </span>csv-aws-example.csv
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>您将收到一个错误，因为脚本尚未配置为访问您的 wis2box 上的 MinIO 端点。</p>
</div>
<p>脚本需要知道访问您的 wis2box 上的 MinIO 的正确端点。如果 wis2box 在您的主机上运行，MinIO 端点可在 <code>http://&lt;your-host&gt;:9000</code> 获得。脚本还需要更新您的存储密码和存储数据的 MinIO 存储桶中的路径。</p>
<div class="admonition question">
<p class="admonition-title">更新脚本并摄取 CSV 数据</p>
<p>编辑脚本 <code>copy_file_to_incoming.py</code> 以解决错误，使用以下方法之一：
- 从命令行：使用 <code>nano</code> 或 <code>vim</code> 文本编辑器编辑脚本
- 使用 WinSCP：使用文件协议 <code>SCP</code> 启动一个新连接，并使用与您的 SSH 客户端相同的凭据。导航到目录 <code>exercise-materials/data-ingest-exercises</code> 并使用内置文本编辑器编辑 <code>copy_file_to_incoming.py</code></p>
<p>确保您：</p>
<ul>
<li>定义了您的主机的正确 MinIO 端点</li>
<li>为您的 MinIO 实例提供了正确的存储密码</li>
<li>提供了存储数据的 MinIO 存储桶中的正确路径</li>
</ul>
<p>重新运行脚本将样本数据文件 <code>csv-aws-example.csv</code> 摄取到 MinIO：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>copy_file_to_incoming.py<span class="w"> </span>csv-aws-example.csv
</code></pre></div>
<p>并确保错误已解决。</p>
</div>
<p>您可以通过检查 MinIO 用户界面来验证数据是否正确上传，并查看样本数据是否在 <code>wis2box-incoming</code> 存储桶的正确目录中。</p>
<p>您可以使用 Grafana 仪表板来检查数据摄取工作流的状态。</p>
<p>最后，您可以使用 MQTT Explorer 检查是否为您摄取的数据发布了通知。您应该看到 CSV 数据被转换为 BUFR 格式，并且发布了一个带有 "canonical" url 的 WIS2 数据通知，以启用下载 BUFR 数据。</p>
<hzh-practical-sessions-automating-data-ingestion-2 id="zh-practical-sessions-automating-data-ingestion-2">练习 2：摄取二进制数据</h2>
<p>接下来，我们尝试使用 MinIO Python 客户端摄取 BUFR 格式的二进制数据。</p>
<p>wis2box 可以使用 <code>wis2box.data.bufr4.ObservationDataBUFR</code> 插件摄取 BUFR 格式的二进制数据。</p>
<p>此插件将 BUFR 文件拆分为单个 BUFR 消息，并将每个消息发布到 MQTT 代理。如果相应的 BUFR 消息的站点未在 wis2box 站点元数据中定义，则不会发布该消息。</p>
<p>由于您在上一次会话中使用了 <code>surface-based-observations/synop</code> 模板，您的数据映射包括了插件 <code>FM-12 数据转换为 BUFR</code>。此插件加载模块 <code>wis2box.data.synop2bufr.ObservationDataSYNOP2BUFR</code> 来摄取数据。</p>
<div class="admonition question">
<p class="admonition-title">摄取 BUFR 格式的二进制数据</p>
<p>运行以下命令将二进制数据文件 <code>bufr-example.bin</code> 复制到 MinIO 的 <code>wis2box-incoming</code> 存储桶中：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>copy_file_to_incoming.py<span class="w"> </span>bufr-example.bin
</code></pre></div>
</div>
<p>检查 Grafana 仪表板和 MQTT Explorer，看看测试数据是否成功摄取和发布，如果您看到任何错误，请尝试解决它们。</p>
<div class="admonition question">
<p class="admonition-title">验证数据摄取</p>
<p>这个数据样本发布了多少条消息到 MQTT 代理？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>如果您成功摄取并发布了最后一个数据样本，您应该在 wis2box MQTT 代理上收到了 10 条新通知。每条通知对应一次观测时间戳的一个站点的数据。</p>
<p>插件 <code>wis2box.data.bufr4.ObservationDataBUFR</code> 将 BUFR 文件拆分为单个 BUFR 消息，并为每个站点和观测时间戳发布一条消息。</p>
</details>
<h2 id="zh-practical-sessions-automating-data-ingestion-3-ascii-synop">练习 3：摄取 ASCII 格式的 SYNOP 数据</h2>
<p>在上一次会话中，我们使用 <strong>wis2box-webapp</strong> 中的 SYNOP 表单摄取了 ASCII 格式的 SYNOP 数据。您也可以通过将数据上传到 MinIO 来摄取 ASCII 格式的 SYNOP 数据。</p>
<p>在上一次会话中，您应该已经创建了一个包括插件 'FM-12 数据转换为 BUFR' 的数据集：</p>
<p><img alt="数据集映射" src="../zh/assets/img/wis2box-data-mappings.png" width="800"></p>
<p>此插件加载模块 <code>wis2box.data.synop2bufr.ObservationDataSYNOP2BUFR</code> 来摄取数据。</p>
<p>尝试使用 MinIO Python 客户端摄取测试数据 <code>synop-202307.txt</code> 和 <code>synop-202308.txt</code> 到您的 wis2box 实例中。</p>
<p>注意这两个文件包含相同的内容，但文件名不同。文件名用于确定数据样本的日期。</p>
<p>synop2bufr 插件依赖于一个文件模式来从文件名中提取日期。正则表达式中的第一个组用于提取年份，第二个组用于提取月份。</p>
<div class="admonition question">
<p class="admonition-title">摄取 FM-12 SYNOP ASCII 格式数据</p>
<p>回到您的浏览器中的 MinIO 界面，导航到 <code>wis2box-incoming</code> 存储桶并进入您在上一个练习中上传测试数据的路径。</p>
<p>上传新文件到 MinIO 的 <code>wis2box-incoming</code> 存储桶中正确的路径以触发数据摄取工作流。</p>
<p>检查 Grafana 仪表板和 MQTT Explorer，看看测试数据是否成功摄取和发布。</p>
<p>发布到 MQTT 代理的两条消息中的 <code>properties.datetime</code> 有什么不同？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>检查 MQTT Explorer 中最后两个通知的属性，您将注意到一个通知有：</p>
<div class="highlight"><pre><span></span><code>&quot;properties&quot;: {
    &quot;data_id&quot;: &quot;wis2/urn:wmo:md:nl-knmi-test:surface-based-observations.synop/WIGOS_0-20000-0-60355_20230703T090000&quot;,
    &quot;datetime&quot;: &quot;2023-07-03T09:00:00Z&quot;,
    ...
</code></pre></div>
<p>而另一个通知有：</p>
<div class="highlight"><pre><span></span><code>&quot;properties&quot;: {
    &quot;data_id&quot;: &quot;wis2/urn:wmo:md:nl-knmi-test:surface-based-observations.synop/WIGOS_0-20000-0-60355_20230803T090000&quot;,
    &quot;datetime&quot;: &quot;2023-08-03T09:00:00Z&quot;,
    ...
</code></pre></div>
<p>文件名被用来确定数据样本的年份和月份。</p>
</details>
<h2 id="zh-practical-sessions-automating-data-ingestion-4-sftp-minio">练习 4：使用 SFTP 将数据摄取到 MinIO</h2>
<p>数据也可以通过 SFTP 摄取到 MinIO。</p>
<p>wis2box 堆栈中启用的 MinIO 服务在端口 8022 上启用了 SFTP。您可以使用与 MinIO 用户界面相同的凭据通过 SFTP 访问 MinIO。在这个练习中，我们将使用 MinIO 服务中定义的 <code>wis2box.env</code> 中的管理员凭据，但您也可以在 MinIO 用户界面中创建额外的用户。</p>
<p>要通过 SFTP 访问 MinIO，您可以使用任何 SFTP 客户端软件。在这个练习中，我们将使用 WinSCP，这是一个适用于 Windows 的免费 SFTP 客户端。</p>
<p>使用 WinSCP，您的连接如下所示：</p>
<p><img alt="winscp-sftp-connection" src="../zh/assets/img/winscp-sftp-connection.png" width="400"></p>
<p>对于用户名和密码，请使用您的 <code>wis2box.env</code> 文件中的 <code>WIS2BOX_STORAGE_USERNAME</code> 和 <code>WIS2BOX_STORAGE_PASSWORD</code> 环境变量的值。点击 'save' 保存会话，然后点击 'login' 连接。</p>
<p>登录后，您将看到根目录中的 MinIO 存储桶 <code>wis2box-incoming</code> 和 <code>wis2box-public</code>。您可以将数据上传到 <code>wis2box-incoming</code> 存储桶以触发数据摄取工作流。</p>
<p>点击 <code>wis2box-incoming</code> 存储桶进入此存储桶，然后右键选择 <em>New</em>-&gt;<em>Directory</em> 在 <code>wis2box-incoming</code> 存储桶中创建一个新目录。</p>
<p>创建目录 <em>not-a-valid-path</em> 并上传文件 <em>randomfile.txt</em> 到此目录中（您可以使用您喜欢的任何文件）。</p>
<p>然后检查端口 3000 的 Grafana 仪表板，看看是否触发了数据摄取工作流。您应该看到：</p>
<p><em>ERROR - Path validation error: Could not match http://minio:9000/wis2box-incoming/not-a-valid-path/randomfile.txt to dataset, path should include one of the following: ...</em></p>
<p>错误表明文件已上传到 MinIO 并触发了数据摄取工作流，但由于路径与 wis2box 实例中的任何数据集不匹配，数据映射失败。</p>
<p>您也可以使用命令行中的 <code>sftp</code>：</p>
<p><div class="highlight"><pre><span></span><code>sftp<span class="w"> </span>-P<span class="w"> </span><span class="m">8022</span><span class="w"> </span>-oBatchMode<span class="o">=</span>no<span class="w"> </span>-o<span class="w"> </span><span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no<span class="w"> </span>&lt;my-hostname-or-ip&gt;
</code></pre></div>
使用在 <code>wis2box.env</code> 中为 <code>WIS2BOX_STORAGE_USERNAME</code> 和 <code>WIS2BOX_STORAGE_PASSWORD</code> 环境变量定义的凭据登录，导航到 <code>wis2box-incoming</code> 存储桶，然后创建一个目录并按如下方式上传一个文件：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>wis2box-incoming
mkdir<span class="w"> </span>not-a-valid-path
<span class="nb">cd</span><span class="w"> </span>not-a-valid-path
put<span class="w"> </span>~/exercise-materials/data-ingest-exercises/synop.txt<span class="w"> </span>.
</code></pre></div>
<p>这将在 Grafana 仪表板中导致一个“路径验证错误”，表明文件已上传到 MinIO。</p>
<p>要退出 sftp 客户端，请输入 <code>exit</code>。</p>
<div class="admonition question">
<p class="admonition-title">使用 SFTP 将数据摄取到 MinIO</p>
<p>尝试使用 SFTP 将文件 <code>synop.txt</code> 摄取到您的 wis2box 实例中以触发数据摄取工作流。</p>
<p>检查 MinIO 用户界面，看看文件是否上传到 <code>wis2box-incoming</code> 存储桶中的正确路径。</p>
<p>检查 Grafana 仪表板，看看数据摄取工作流是否被触发或是否有任何错误。</p>
</div>
<p>为确保您的数据正确摄取，请确保文件上传到与您数据集的数据集 id 或主题匹配的 <code>wis2box-incoming</code> 存储桶中的目录。</p>
<h2 id="zh-practical-sessions-automating-data-ingestion-_4">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了如何：</p>
<ul>
<li>使用 Python 脚本和 MinIO Python 客户端触发 wis2box 工作流</li>
<li>使用不同的数据插件摄取不同的数据格式</li>
<li>使用 SFTP 上传数据到 MinIO</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications" heading-number="2.11"><h1 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-wis2-gts">在 WIS2 通知中添加 GTS 头部信息</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>配置文件名与 GTS 头部信息之间的映射</li>
<li>使用与 GTS 头部信息匹配的文件名导入数据</li>
<li>在 WIS2 通知中查看 GTS 头部信息</li>
</ul>
</div>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-_1">引言</h2>
<p>在向 WIS2 过渡阶段中希望停止在 GTS 上的数据传输的 WMO 成员需要在他们的 WIS2 通知中添加 GTS 头部信息。这些头部信息使得 WIS2 到 GTS 网关能够将数据转发到 GTS 网络。</p>
<p>这允许已迁移到使用 WIS2 节点发布数据的成员禁用他们的 MSS 系统，并确保他们的数据仍然可以供尚未迁移到 WIS2 的成员使用。</p>
<p>WIS2 通知消息中需要添加 GTS 属性作为额外的属性。GTS 属性是一个包含了数据转发到 GTS 网络所需的 GTS 头部信息的 JSON 对象。</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;gts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ttaaii&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FTAE31&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cccc&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VTBB&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>在 wis2box 中，您可以通过提供一个名为 <code>gts_headers_mapping.csv</code> 的额外文件来自动向 WIS2 通知添加这些信息，该文件包含将 GTS 头部信息映射到传入文件名所需的信息。</p>
<p>这个文件应该放在由 <code>WIS2BOX_HOST_DATADIR</code> 在您的 <code>wis2box.env</code> 中定义的目录中，并应包含以下列：</p>
<ul>
<li><code>string_in_filepath</code>：文件名中的一部分字符串，将用于匹配 GTS 头部信息</li>
<li><code>TTAAii</code>：要添加到 WIS2 通知的 TTAAii 头部</li>
<li><code>CCCC</code>：要添加到 WIS2 通知的 CCCC 头部</li>
</ul>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-_2">准备工作</h2>
<p>确保您有 SSH 访问权限到您的学生 VM，并且您的 wis2box 实例正在运行。</p>
<p>确保您已使用 MQTT Explorer 连接到您的 wis2box 实例的 MQTT 代理。您可以使用公共凭据 <code>everyone/everyone</code> 连接到代理。</p>
<p>确保您已经打开了一个网页浏览器，通过访问 <code>http://&lt;your-host&gt;:3000</code> 查看您实例的 Grafana 仪表板。</p>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-gts_headers_mappingcsv">创建 <code>gts_headers_mapping.csv</code></h2>
<p>要在您的 WIS2 通知中添加 GTS 头部信息，需要一个 CSV 文件来映射 GTS 头部信息到传入的文件名。</p>
<p>CSV 文件应该命名为（确切地）<code>gts_headers_mapping.csv</code> 并且应该放在由 <code>WIS2BOX_HOST_DATADIR</code> 在您的 <code>wis2box.env</code> 中定义的目录中。</p>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-1-gts_headers_mappingcsv">练习 1：提供一个 <code>gts_headers_mapping.csv</code> 文件</h2>
<p>将文件 <code>exercise-materials/gts-headers-exercises/gts_headers_mapping.csv</code> 复制到您的 wis2box 实例并放在由 <code>WIS2BOX_HOST_DATADIR</code> 在您的 <code>wis2box.env</code> 中定义的目录中。</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>~/exercise-materials/gts-headers-exercises/gts_headers_mapping.csv<span class="w"> </span>~/wis2box-data
</code></pre></div>
<p>然后重启 wis2box-management 容器以应用更改：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>restart<span class="w"> </span>wis2box-management
</code></pre></div>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-2-gts">练习 2：导入带有 GTS 头部信息的数据</h2>
<p>将文件 <code>exercise-materials/gts-headers-exercises/A_SMRO01YRBK171200_C_EDZW_20240717120502.txt</code> 复制到由 <code>WIS2BOX_HOST_DATADIR</code> 在您的 <code>wis2box.env</code> 中定义的目录中：</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>~/exercise-materials/gts-headers-exercises/A_SMRO01YRBK171200_C_EDZW_20240717120502.txt<span class="w"> </span>~/wis2box-data
</code></pre></div>
<p>然后登录到 <strong>wis2box-management</strong> 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>从 wis2box 命令行中，我们可以将样本数据文件 <code>A_SMRO01YRBK171200_C_EDZW_20240717120502.txt</code> 导入到特定数据集中，如下所示：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/A_SMRO01YRBK171200_C_EDZW_20240717120502.txt<span class="w"> </span>--metadata-id<span class="w"> </span>urn:wmo:md:not-my-centre:core.surface-based-observations.synop
</code></pre></div>
<p>确保将 <code>metadata-id</code> 选项替换为您数据集的正确标识符。</p>
<p>检查 Grafana 仪表板以查看数据是否正确导入。如果您看到任何警告或错误，尝试修复它们并重复 <code>wis2box data ingest</code> 命令。</p>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-3-wis2-gts">练习 3：查看 WIS2 通知中的 GTS 头部信息</h2>
<p>转到 MQTT Explorer 并检查您刚刚导入的数据的 WIS2 通知消息。</p>
<p>WIS2 通知消息应包含您在 <code>gts_headers_mapping.csv</code> 文件中提供的 GTS 头部信息。</p>
<h2 id="zh-practical-sessions-adding-gts-headers-to-wis2-notifications-_3">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了如何：
  - 向您的 WIS2 通知添加 GTS 头部信息
  - 通过您的 wis2box 安装验证 GTS 头部信息是否可用</p>
</div></section><section class="print-page" id="zh-practical-sessions-datasets-with-access-control" heading-number="2.12"><h1 id="zh-practical-sessions-datasets-with-access-control-_1">设置带访问控制的推荐数据集</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>创建一个数据政策为“推荐”的新数据集</li>
<li>向数据集添加访问令牌</li>
<li>验证未使用访问令牌无法访问数据集</li>
<li>将访问令牌添加到 HTTP 头部以访问数据集</li>
</ul>
</div>
<h2 id="zh-practical-sessions-datasets-with-access-control-_2">引言</h2>
<p>在 WMO 中不被视为“核心”数据集的数据集可以选择配置访问控制政策。wis2box 提供了一种机制，可以向数据集添加访问令牌，这将阻止用户在不提供 HTTP 头部中的访问令牌的情况下下载数据。</p>
<h2 id="zh-practical-sessions-datasets-with-access-control-_3">准备工作</h2>
<p>确保您拥有对学生虚拟机的 SSH 访问权限，并且您的 wis2box 实例正在运行。</p>
<p>确保您已使用 MQTT Explorer 连接到 wis2box 实例的 MQTT 代理。您可以使用公共凭据 <code>everyone/everyone</code> 连接到代理。</p>
<p>确保您的浏览器已打开并通过 <code>http://&lt;your-host&gt;/wis2box-webapp</code> 访问您实例的 wis2box-webapp。</p>
<h2 id="zh-practical-sessions-datasets-with-access-control-1">练习 1：创建一个数据政策为“推荐”的新数据集</h2>
<p>转到 wis2box-webapp 中的“数据集编辑器”页面并创建一个新数据集。使用与之前实践课程相同的中心 ID，并使用模板='surface-weather-observations/synop'。</p>
<p>点击“确定”继续。</p>
<p>在数据集编辑器中，将数据政策设置为“推荐”（注意，更改数据政策将更新“主题层级”）。
用一个描述性名称替换自动生成的“本地 ID”，例如 'recommended-data-with-access-control':</p>
<p><img alt="create-dataset-recommended" src="../zh/assets/img/create-dataset-recommended.png" width="800"></p>
<p>继续填写空间属性和联系信息所需的字段，并“验证表单”以检查是否有错误。</p>
<p>最后，使用之前创建的认证令牌提交数据集，并检查新数据集是否已在 wis2box-webapp 中创建。</p>
<p>检查 MQTT-explorer，看看您是否收到了在主题 <code>origin/a/wis2/&lt;your-centre-id&gt;/metadata</code> 上宣布新的发现元数据记录的 WIS2 通知消息。</p>
<hzh-practical-sessions-datasets-with-access-control-2 id="zh-practical-sessions-datasets-with-access-control-2">练习 2：向数据集添加访问令牌</h2>
<p>登录到 wis2box-management 容器，</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>在容器内的命令行中，您可以使用 <code>wis2box auth add-token</code> 命令来保护一个数据集，使用 <code>--metadata-id</code> 标志来指定数据集的元数据标识符和作为参数的访问令牌。</p>
<p>例如，向元数据标识符为 <code>urn:wmo:md:not-my-centre:core.surface-based-observations.synop</code> 的数据集添加访问令牌 <code>S3cr3tT0k3n</code>：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>auth<span class="w"> </span>add-token<span class="w"> </span>--metadata-id<span class="w"> </span>urn:wmo:md:not-my-centre:reco.surface-based-observations.synop<span class="w"> </span>S3cr3tT0k3n
</code></pre></div>
<p>退出 wis2box-management 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<h2 id="zh-practical-sessions-datasets-with-access-control-3">练习 3：向数据集发布一些数据</h2>
<p>将文件 <code>exercise-materials/access-control-exercises/aws-example2.csv</code> 复制到由 <code>WIS2BOX_HOST_DATADIR</code> 在您的 <code>wis2box.env</code> 中定义的目录：</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>~/exercise-materials/access-control-exercises/aws-example2.csv<span class="w"> </span>~/wis2box-data
</code></pre></div>
<p>然后使用 WinSCP 或命令行编辑器编辑文件 <code>aws-example2.csv</code>，并更新输入数据中的 WIGOS 站点标识符，以匹配您 wis2box 实例中的站点。</p>
<p>接下来，转到 wis2box-webapp 中的站点编辑器。对于您在 <code>aws-example2.csv</code> 中使用的每个站点，更新“主题”字段以匹配您在上一个练习中创建的数据集的“主题”。</p>
<p>这个站点现在将与两个主题关联，一个用于“核心”数据集，一个用于“推荐”数据集：</p>
<p><img alt="edit-stations-add-topics" src="../zh/assets/img/edit-stations-add-topics.png" width="600"></p>
<p>您将需要使用您的 <code>collections/stations</code> 令牌来保存更新的站点数据。</p>
<p>接下来，登录到 wis2box-management 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-1.0.0rc1
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>从 wis2box 命令行中，我们可以将样本数据文件 <code>aws-example2.csv</code> 导入到特定数据集中，如下所示：</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/aws-example2.csv<span class="w"> </span>--metadata-id<span class="w"> </span>urn:wmo:md:not-my-centre:reco.surface-based-observations.synop
</code></pre></div>
<p>确保提供正确的数据集元数据标识符，并<strong>检查您在 MQTT Explorer 中是否收到 WIS2 数据通知</strong>，在主题 <code>origin/a/wis2/&lt;your-centre-id&gt;/data/recommended/surface-based-observations/synop</code> 上。</p>
<p>检查 WIS2 通知消息中的规范链接，并复制/粘贴该链接到浏览器中尝试下载数据。</p>
<p>您应该看到 403 Forbidden 错误。</p>
<h2 id="zh-practical-sessions-datasets-with-access-control-4-http">练习 4：将访问令牌添加到 HTTP 头部以访问数据集</h2>
<p>为了演示访问数据集需要访问令牌，我们将使用命令行功能 <code>wget</code> 重现您在浏览器中看到的错误。</p>
<p>在您的学生 VM 的命令行中，使用您从 WIS2 通知消息中复制的规范链接的 <code>wget</code> 命令。</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>&lt;canonical-link&gt;
</code></pre></div>
<p>您应该看到 HTTP 请求返回 <em>401 Unauthorized</em>，数据未被下载。</p>
<p>现在将访问令牌添加到 HTTP 头部以访问数据集。</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>--header<span class="o">=</span><span class="s2">&quot;Authorization: Bearer S3cr3tT0k3n&quot;</span><span class="w"> </span>&lt;canonical-link&gt;
</code></pre></div>
<p>现在数据应该被成功下载。</p>
<h2 id="zh-practical-sessions-datasets-with-access-control-_4">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了：</p>
<ul>
<li>创建一个数据政策为“推荐”的新数据集</li>
<li>向数据集添加访问令牌</li>
<li>验证未使用访问令牌无法访问数据集</li>
<li>将访问令牌添加到 HTTP 头部以访问数据集</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-downloading-data-from-wis2" heading-number="2.13"><h1 id="zh-practical-sessions-downloading-data-from-wis2-wis2">从 WIS2 下载和解码数据</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果！</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>使用“wis2downloader”订阅 WIS2 数据通知并将数据下载到您的本地系统</li>
<li>在 Grafana 仪表板中查看下载状态</li>
<li>使用“decode-bufr-jupyter”容器解码一些下载的数据</li>
</ul>
</div>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-_1">引言</h2>
<p>在本课程中，您将学习如何设置订阅到 WIS2 Broker 并使用 wis2box 中包含的“wis2downloader”服务自动下载数据到您的本地系统。</p>
<div class="admonition note">
<p class="admonition-title">关于 wis2downloader</p>
<p>wis2downloader 也可以作为独立服务在发布 WIS2 通知的系统之外的不同系统上运行。请访问 <a href="https://pypi.org/project/wis2downloader/">wis2downloader</a> 了解更多关于将 wis2downloader 作为独立服务使用的信息。</p>
<p>如果您想开发自己的服务来订阅 WIS2 通知并下载数据，您可以使用 <a href="https://github.com/wmo-im/wis2downloader">wis2downloader 源代码</a> 作为参考。</p>
</div>
<div class="admonition other tools for accessing wis2 data">
<p class="admonition-title">Other</p>
<p>以下工具也可以用来发现和访问 WIS2 的数据：</p>
<ul>
<li><a href="https://github.com/wmo-im/pywiscat">pywiscat</a> 提供了在 WIS2 全球发现目录上的搜索功能，支持报告和分析 WIS2 目录及其相关的发现元数据</li>
<li><a href="https://github.com/wmo-im/pywis-pubsub">pywis-pubsub</a> 提供了从 WIS2 基础设施服务订阅和下载 WMO 数据的功能</li>
</ul>
</div>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-_2">准备工作</h2>
<p>开始之前，请登录到您的学生 VM 并确保您的 wis2box 实例正在运行。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-1-grafana-wis2download">练习 1：在 Grafana 中查看 wis2download 仪表板</h2>
<p>打开一个网页浏览器，通过访问 <code>http://&lt;your-host&gt;:3000</code> 导航到您的 wis2box 实例的 Grafana 仪表板。</p>
<p>点击左侧菜单中的仪表板，然后选择 <strong>wis2downloader 仪表板</strong>。</p>
<p>您应该会看到以下仪表板：</p>
<p><img alt="wis2downloader 仪表板" src="../zh/assets/img/wis2downloader-dashboard.png" /></p>
<p>此仪表板基于 wis2downloader 服务发布的指标，将显示当前正在进行的下载状态。</p>
<p>在左上角您可以看到当前激活的订阅。</p>
<p>保持此仪表板打开，因为您将在下一个练习中使用它来监控下载进度。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-2-wis2downloader">练习 2：审查 wis2downloader 配置</h2>
<p>wis2box 堆栈启动的 wis2downloader 服务可以使用在您的 wis2box.env 文件中定义的环境变量进行配置。</p>
<p>wis2downloader 使用以下环境变量：</p>
<pre><code>- DOWNLOAD_BROKER_HOST：连接的 MQTT 代理的主机名。默认为 globalbroker.meteo.fr
- DOWNLOAD_BROKER_PORT：连接的 MQTT 代理的端口。默认为 443（用于 websockets 的 HTTPS）
- DOWNLOAD_BROKER_USERNAME：用于连接 MQTT 代理的用户名。默认为 everyone
- DOWNLOAD_BROKER_PASSWORD：用于连接 MQTT 代理的密码。默认为 everyone
- DOWNLOAD_BROKER_TRANSPORT：websockets 或 tcp，用于连接 MQTT 代理的传输机制。默认为 websockets
- DOWNLOAD_RETENTION_PERIOD_HOURS：下载数据的保留期（小时）。默认为 24
- DOWNLOAD_WORKERS：使用的下载工作数。默认为 8。决定并行下载的数量。
- DOWNLOAD_MIN_FREE_SPACE_GB：在托管下载的卷上保留的最小空闲空间（GB）。默认为 1。
</code></pre>
<p>要审查 wis2downloader 的当前配置，您可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>~/wis2box-1.0.0rc1/wis2box.env<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>DOWNLOAD
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">审查 wis2downloader 的配置</p>
<p>wis2downloader 默认连接的 MQTT 代理是什么？</p>
<p>下载数据的默认保留期是多少？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>wis2downloader 默认连接的 MQTT 代理是 <code>globalbroker.meteo.fr</code>。</p>
<p>下载数据的默认保留期是 24 小时。</p>
</details>
<div class="admonition note">
<p class="admonition-title">更新 wis2downloader 的配置</p>
<p>要更新 wis2downloader 的配置，您可以编辑 wis2box.env 文件。要应用更改，您可以重新运行 wis2box 堆栈的启动命令：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
</code></pre></div>
<p>然后您将看到 wis2downloader 服务使用新配置重新启动。</p>
</div>
<p>您可以保持默认配置以进行此练习。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-3-wis2downloader">练习 3：向 wis2downloader 添加订阅</h2>
<p>在 <strong>wis2downloader</strong> 容器内部，您可以使用命令行列出、添加和删除订阅。</p>
<p>要登录到 <strong>wis2downloader</strong> 容器，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2downloader
</code></pre></div>
<p>然后使用以下命令列出当前激活的订阅：</p>
<div class="highlight"><pre><span></span><code>wis2downloader<span class="w"> </span>list-subscriptions
</code></pre></div>
<p>此命令返回一个空列表，因为当前没有激活的订阅。</p>
<p>为了本练习的目的，我们将订阅以下主题 <code>cache/a/wis2/de-dwd-gts-to-wis2/#</code>，以订阅由 DWD 托管的 GTS-to-WIS2 网关发布的数据和来自 Global Cache 的下载通知。</p>
<p>要添加此订阅，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>wis2downloader<span class="w"> </span>add-subscription<span class="w"> </span>--topic<span class="w"> </span>cache/a/wis2/de-dwd-gts-to-wis2/#
</code></pre></div>
<p>然后通过输入 <code>exit</code> 退出 <strong>wis2downloader</strong> 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<p>检查 Grafana 中的 wis2downloader 仪表板以查看已添加的新订阅。等待几分钟，您应该会看到首次下载开始。一旦确认下载已开始，请进行下一个练习。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-4">练习 4：查看下载的数据</h2>
<p>wis2box 堆栈中的 wis2downloader 服务将数据下载到您在 wis2box.env 文件中定义的 WIS2BOX_HOST_DATADIR 目录中的 'downloads' 目录。要查看 downloads 目录的内容，您可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-R<span class="w"> </span>~/wis2box-data/downloads
</code></pre></div>
<p>请注意，下载的数据存储在以 WIS2 通知发布的主题命名的目录中。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-5-wis2downloader">练习 5：从 wis2downloader 中删除订阅</h2>
<p>接下来，重新登录到 wis2downloader 容器：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2downloader
</code></pre></div>
<p>并使用以下命令从 wis2downloader 中删除您添加的订阅：</p>
<div class="highlight"><pre><span></span><code>wis2downloader<span class="w"> </span>remove-subscription<span class="w"> </span>--topic<span class="w"> </span>cache/a/wis2/de-dwd-gts-to-wis2/#
</code></pre></div>
<p>然后通过输入 <code>exit</code> 退出 wis2downloader 容器：</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<p>检查 Grafana 中的 wis2downloader 仪表板以查看已删除的订阅。您应该会看到下载停止。</p>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-6-wis2training-broker">练习 6：订阅 wis2training-broker 并设置新订阅</h2>
<p>在下一个练习中，我们将订阅 wis2training-broker。</p>
<p>这演示了如何订阅非默认代理，并将允许您下载来自 WIS2 培训代理的一些数据。</p>
<p>编辑 wis2box.env 文件并将 DOWNLOAD_BROKER_HOST 更改为 <code>wis2training-broker.wis2dev.io</code>，将 DOWNLOAD_BROKER_PORT 更改为 <code>1883</code> 并将 DOWNLOAD_BROKER_TRANSPORT 更改为 <code>tcp</code>：</p>
<div class="highlight"><pre><span></span><code># downloader settings
DOWNLOAD_BROKER_HOST=wis2training-broker.wis2dev.io
DOWNLOAD_BROKER_PORT=1883
DOWNLOAD_BROKER_USERNAME=everyone
DOWNLOAD_BROKER_PASSWORD=everyone
# download transport mechanism (tcp or websockets)
DOWNLOAD_BROKER_TRANSPORT=tcp
</code></pre></div>
<p>然后重新启动 wis2box 堆栈以应用更改：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
</code></pre></div>
<p>检查 wis2downloader 的日志以查看是否成功连接到新代理：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>wis2downloader
</code></pre></div>
<p>您应该会看到以下日志消息：</p>
<div class="highlight"><pre><span></span><code>...
INFO - Connecting...
INFO - Host: wis2training-broker.wis2dev.io, port: 1883
INFO - Connected successfully
</code></pre></div>
<p>现在我们将设置一个新订阅，以从 WIS2 培训代理下载飓风路径数据。</p>
<p>登录到 <strong>wis2downloader</strong> 容器：</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2downloader
</code></pre></div>
<p>并执行以下命令（复制粘贴以避免打字错误）：</p>
<div class="highlight"><pre><span></span><code>wis2downloader<span class="w"> </span>add-subscription<span class="w"> </span>--topic<span class="w"> </span>origin/a/wis2/int-wis2-training/data/core/weather/prediction/forecast/medium-range/probabilistic/trajectory
</code></pre></div>
<p>通过输入 <code>exit</code> 退出 <strong>wis2downloader</strong> 容器。</p>
<p>等到您在 Grafana 中的 wis2downloader 仪表板上看到下载开始。</p>
<div class="admonition note">
<p class="admonition-title">从 WIS2 培训代理下载数据</p>
<p>WIS2 培训代理是用于培训目的的测试代理，可能不会一直发布数据。</p>
<p>在面对面的培训课程中，当地培训师将确保 WIS2 培训代理为您发布数据以供下载。</p>
<p>如果您在培训课程之外进行此练习，您可能不会看到任何正在下载的数据。</p>
</div>
<p>通过再次检查 wis2downloader 的日志来确认数据已下载：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>wis2downloader
</code></pre></div>
<p>您应该会看到类似以下的日志消息：</p>
<div class="highlight"><pre><span></span><code>[...] INFO - Message received under topic origin/a/wis2/int-wis2-training/data/core/weather/prediction/forecast/medium-range/probabilistic/trajectory
[...] INFO - Downloaded A_JSXX05ECEP020000_C_ECMP_...
</code></pre></div>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-7">练习 7：解码下载的数据</h2>
<p>为了演示如何解码下载的数据，我们将使用 'decode-bufr-jupyter' 映像启动一个新容器。</p>
<p>此容器将在您的实例上启动 Jupyter 笔记本服务器，其中包括您可以用来解码 BUFR 数据的“ecCodes”库。</p>
<p>我们将使用 <code>~/exercise-materials/notebook-examples</code> 中包含的示例笔记本来解码飓风路径的下载数据。</p>
<p>要启动容器，请使用以下命令：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>decode-bufr-jupyter<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>~/wis2box-data/downloads:/root/downloads<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">JUPYTER_TOKEN</span><span class="o">=</span>dataismagic!<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>mlimper/decode-bufr-jupyter
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">关于 decode-bufr-jupyter 容器</p>
<p><code>decode-bufr-jupyter</code> 容器是一个自定义容器，其中包含 ecCodes 库并运行 Jupyter 笔记本服务器。该容器基于一个包含用于解码 BUFR 数据的 <code>ecCodes</code> 库以及用于绘图和数据分析的库的映像。</p>
<p>上述命令以分离模式启动容器，名称为 <code>decode-bufr-jupyter</code>，端口 8888 映射到主机系统，环境变量 <code>JUPYTER_TOKEN</code> 设置为 <code>dataismagic!</code>。</p>
<p>上述命令还将 <code>~/wis2box-data/downloads</code> 目录挂载到容器中的 <code>/root/downloads</code>。这确保了下载的数据可用于 Jupyter 笔记本服务器。</p>
</div>
<p>容器启动后，您可以通过在网页浏览器中导航到 <code>http://&lt;your-host&gt;:8888</code> 来访问 Jupyter 笔记本服务器。</p>
<p>您将看到一个请求您输入“密码或令牌”的屏幕。</p>
<p>提供令牌 <code>dataismagic!</code> 登录到 Jupyter 笔记本服务器。</p>
<p>登录后，您应该会看到以下屏幕，列出了容器中的目录：</p>
<p><img alt="Jupyter 笔记本主页" src="../zh/assets/img/jupyter-files-screen1.png" /></p>
<p>双击 <code>example-notebooks</code> 目录将其打开。</p>
<p>您应该会看到以下屏幕，列出了示例笔记本，双击 <code>tropical_cyclone_track.ipynb</code> 笔记本将其打开：</p>
<p><img alt="Jupyter 笔记本示例笔记本" src="../zh/assets/img/jupyter-files-screen2.png" /></p>
<p>现在您应该进入了解码热带飓风路径数据的 Jupyter 笔记本：</p>
<p><img alt="Jupyter 笔记本热带飓风路径" src="../zh/assets/img/jupyter-tropical-cyclone-track.png" /></p>
<p>阅读笔记本中的说明并运行单元格以解码热带飓风路径的下载数据。通过点击单元格然后点击工具栏中的运行按钮或按 <code>Shift+Enter</code> 运行每个单元格。</p>
<p>最后您应该会看到热带飓风路径的打击概率图：</p>
<p><img alt="热带飓风路径" src="../zh/assets/img/tropical-cyclone-track-map.png" /></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>结果显示了 200 公里内热带风暴路径的预测概率。您将如何更新笔记本以显示 300 公里内热带风暴路径的预测概率？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>要更新笔记本以显示不同距离内热带风暴路径的预测概率，您可以更新计算打击概率的代码块中的 <code>distance_threshold</code> 变量。</p>
<p>要显示 300 公里内热带风暴路径的预测概率，</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 设置距离阈值（米）</span>
<span class="n">distance_threshold</span> <span class="o">=</span> <span class="mi">300000</span>  <span class="c1"># 300 公里转换为米</span>
</code></pre></div>
<p>然后重新运行笔记本中的单元格以查看更新的图表。</p>
</details>
<div class="admonition note">
<p class="admonition-title">解码 BUFR 数据</p>
<p>您刚刚完成的练习提供了一个具体示例，说明您如何使用 ecCodes 库解码 BUFR 数据。不同的数据类型可能需要不同的解码步骤，您可能需要参考您正在处理的数据类型的文档。</p>
<p>有关更多信息，请参阅 <a href="https://confluence.ecmwf.int/display/ECC">ecCodes 文档</a>。</p>
</div>
<h2 id="zh-practical-sessions-downloading-data-from-wis2-_3">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学习了如何：</p>
<ul>
<li>使用 'wis2downloader' 订阅 WIS2 Broker 并将数据下载到您的本地系统</li>
<li>在 Grafana 仪表板中查看下载状态</li>
<li>使用 'decode-bufr-jupyter' 容器解码一些下载的数据</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-discovering-datasets-from-wis2-gdc" heading-number="2.14"><h1 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-wis2">探索 WIS2 全球发现目录中的数据集</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果！</p>
<p>在本实践课程结束时，您将能够：</p>
<ul>
<li>使用 pywiscat 从全球发现目录（GDC）中发现数据集</li>
</ul>
</div>
<h2 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-_1">引言</h2>
<p>在本课程中，您将学习如何从 WIS2 全球发现目录（GDC）中发现数据。</p>
<p>目前，以下 GDC 可用：</p>
<ul>
<li>加拿大环境与气候变化部，加拿大气象服务： <a href="https://wis2-gdc.weather.gc.ca">https://wis2-gdc.weather.gc.ca</a></li>
<li>中国气象局： <a href="https://gdc.wis.cma.cn/api">https://gdc.wis.cma.cn/api</a></li>
<li>德国气象服务： <a href="https://wis2.dwd.de/gdc">https://wis2.dwd.de/gdc</a></li>
</ul>
<p>在本地培训期间，会设置一个本地 GDC，以便参与者查询他们从 wis2box 实例发布的元数据。在这种情况下，培训师将提供本地 GDC 的 URL。</p>
<h2 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-_2">准备工作</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>开始前请登录到您的学生虚拟机。</p>
</div>
<h2 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-pywiscat">安装 pywiscat</h2>
<p>使用 <code>pip3</code> Python 包安装器在您的虚拟机上安装 pywiscat：
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>pywiscat
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>如果遇到以下错误：</p>
<div class="highlight"><pre><span></span><code>WARNING: The script pywiscat is installed in &#39;/home/username/.local/bin&#39; which is not on PATH.
考虑将此目录添加到 PATH 或者，如果您希望抑制此警告，请使用 --no-warn-script-location。
</code></pre></div>
<p>那么运行以下命令：</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/home/<span class="nv">$USER</span>/.local/bin
</code></pre></div>
<p>...其中 <code>$USER</code> 是您在虚拟机上的用户名。</p>
</div>
<p>验证安装是否成功：</p>
<div class="highlight"><pre><span></span><code>pywiscat<span class="w"> </span>--version
</code></pre></div>
<h2 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-pywiscat_1">使用 pywiscat 查找数据</h2>
<p>默认情况下，pywiscat 连接到加拿大的全球发现目录。让我们配置 pywiscat 通过设置 <code>PYWISCAT_GDC_URL</code> 环境变量来查询培训 GDC：</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">PYWISCAT_GDC_URL</span><span class="o">=</span>http://&lt;local-gdc-host-or-ip&gt;
</code></pre></div>
<p>让我们使用 <a href="https://github.com/wmo-im/pywiscat">pywiscat</a> 查询作为培训一部分设置的 GDC。</p>
<div class="highlight"><pre><span></span><code>pywiscat<span class="w"> </span>search<span class="w"> </span>--help
</code></pre></div>
<p>现在搜索 GDC 的所有记录：</p>
<div class="highlight"><pre><span></span><code>pywiscat<span class="w"> </span>search
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>搜索返回了多少条记录？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>返回的记录数取决于您查询的 GDC。使用本地培训 GDC 时，您应该看到记录数等于在其他实践课程中已导入到 GDC 的数据集数量。</p>
</details>
<p>让我们尝试使用关键词查询 GDC：</p>
<div class="highlight"><pre><span></span><code>pywiscat<span class="w"> </span>search<span class="w"> </span>-q<span class="w"> </span>observations
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>结果的数据政策是什么？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>所有返回的数据应指定为“核心”数据</p>
</details>
<p>尝试使用 <code>-q</code> 进行额外的查询</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>-q</code> 标志允许以下语法：</p>
<ul>
<li><code>-q synop</code>：查找包含单词 "synop" 的所有记录</li>
<li><code>-q temp</code>：查找包含单词 "temp" 的所有记录</li>
<li><code>-q "observations AND fiji"</code>：查找包含单词 "observations" 和 "fiji" 的所有记录</li>
<li><code>-q "observations NOT fiji"</code>：查找包含单词 "observations" 但不包含 "fiji" 的所有记录</li>
<li><code>-q "synop OR temp"</code>：查找同时包含 "synop" 或 "temp" 的所有记录</li>
<li><code>-q "obs~"</code>：模糊搜索</li>
</ul>
<p>当搜索带有空格的术语时，请用双引号括起来。</p>
</div>
<p>让我们获取更多我们感兴趣的特定搜索结果的详细信息：</p>
<div class="highlight"><pre><span></span><code>pywiscat<span class="w"> </span>get<span class="w"> </span>&lt;id&gt;
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>使用上一次搜索的 <code>id</code> 值。</p>
</div>
<h2 id="zh-practical-sessions-discovering-datasets-from-wis2-gdc-_3">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学会了：</p>
<ul>
<li>使用 pywiscat 从 WIS2 全球发现目录中发现数据集</li>
</ul>
</div></section><section class="print-page" id="zh-practical-sessions-querying-data-using-the-wis2box-api" heading-number="2.15"><h1 id="zh-practical-sessions-querying-data-using-the-wis2box-api-wis2box-api">使用 wis2box API 查询数据</h1>
<div class="admonition abstract">
<p class="admonition-title">学习成果</p>
<p>通过本实践课程，您将能够：</p>
<ul>
<li>使用 wis2box API 查询和筛选您的气象站</li>
<li>使用 wis2box API 查询和筛选您的数据</li>
</ul>
</div>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_1">引言</h2>
<p>wis2box API 提供了一种机器可读的方式，用于发现和查询已经输入到 wis2box 中的数据。该 API 基于 OGC API - Features 标准，并使用 <a href="https://pygeoapi.io">pygeoapi</a> 实现。</p>
<p>wis2box API 提供以下集合的访问权限：</p>
<ul>
<li>气象站</li>
<li>发现元数据</li>
<li>数据通知</li>
<li>每个配置的数据集一个集合，存储来自 bufr2geojson 的输出（数据映射配置中需要启用插件 <code>bufr2geojson</code> 来填充数据集合中的项目）。</li>
</ul>
<p>在这个实践课程中，您将学习如何使用数据 API 浏览和查询已经输入到 wis2box 中的数据。</p>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_2">准备工作</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>在您的网络浏览器中导航到 wis2box API 登陆页面：</p>
<p><code>http://&lt;your-host&gt;/oapi</code></p>
</div>
<p><img alt="wis2box-api-登陆页面" src="../zh/assets/img/wis2box-api-landing-page.png" width="600"></p>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_3">检查集合</h2>
<p>从登陆页面，点击 'Collections' 链接。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>在结果页面上您看到了多少个数据集合？您认为每个集合代表什么？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>应该显示 4 个集合，包括“气象站”，“发现元数据”，和“数据通知”</p>
</details>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_4">检查气象站</h2>
<p>从登陆页面，点击 'Collections' 链接，然后点击 'Stations' 链接。</p>
<p><img alt="wis2box-api-气象站集合" src="../zh/assets/img/wis2box-api-collections-stations.png" width="600"></p>
<p>点击 'Browse' 链接，然后点击 'json' 链接。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>返回了多少个气象站？将这个数字与 <code>http://&lt;your-host&gt;/wis2box-webapp/station</code> 中的气象站列表进行比较。</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>API 中的气象站数量应该与您在 wis2box webapp 中看到的气象站数量相等。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何查询单个气象站（例如 <code>Balaka</code>）？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>使用 API 查询 <code>http://&lt;your-host&gt;/oapi/collections/stations/items?q=Balaka</code>。</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上述示例基于马拉维测试数据。尝试针对您在之前练习中输入的气象站进行测试。</p>
</div>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_5">检查观测数据</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上述示例基于马拉维测试数据。尝试针对您在练习中输入的观测数据进行测试。</p>
</div>
<p>从登陆页面，点击 'Collections' 链接，然后点击 '来自马拉维的地面天气观测' 链接。</p>
<p><img alt="wis2box-api-马拉维观测集合" src="../zh/assets/img/wis2box-api-collections-malawi-obs.png" width="600"></p>
<p>点击 'Queryables' 链接。</p>
<p><img alt="wis2box-api-马拉维观测集合可查询项" src="../zh/assets/img/wis2box-api-collections-malawi-obs-queryables.png" width="600"></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>哪个可查询项可以用来按气象站标识符过滤？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>正确的可查询项是 <code>wigos_station_identifer</code>。</p>
</details>
<p>导航回前一页（即 <code>http://&lt;your-host&gt;/oapi/collections/urn:wmo:md:mwi:mwi_met_centre:surface-weather-observations</code>）</p>
<p>点击 'Browse' 链接。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何可视化 JSON 响应？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>通过点击页面右上角的 'JSON' 链接，或者在网络浏览器中向 API 请求添加 <code>f=json</code>。</p>
</details>
<p>检查观测数据的 JSON 响应。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>返回了多少条记录？</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何将响应限制为 3 条观测数据？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>在 API 请求中添加 <code>limit=3</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何按最新的观测数据对响应进行排序？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>在 API 请求中添加 <code>sortby=-resultTime</code>（注意 <code>-</code> 符号表示降序排序）。要按最早的观测数据排序，更新请求以包含 <code>sortby=resultTime</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何按单个气象站过滤观测数据？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>在 API 请求中添加 <code>wigos_station_identifier=&lt;WSI&gt;</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何以 CSV 格式接收观测数据？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>在 API 请求中添加 <code>f=csv</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>我们如何显示单个观测数据（id）？</p>
</div>
<details class="success">
<summary>点击以显示答案</summary>
<p>使用针对观测数据的 API 请求中的特征标识符，查询 API <code>http://&lt;your-host&gt;/oapi/collections/{collectionId}/items/{featureId}</code>，其中 <code>{collectionId}</code> 是您的观测数据集合的名称，<code>{itemId}</code> 是感兴趣的单个观测数据的标识符。</p>
</details>
<h2 id="zh-practical-sessions-querying-data-using-the-wis2box-api-_6">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在这个实践课程中，您学习了如何：</p>
<ul>
<li>使用 wis2box API 查询和筛选您的气象站</li>
<li>使用 wis2box API 查询和筛选您的数据</li>
</ul>
</div></section></section>
                    <section class='print-page md-section' id='section-3' heading-number='3'>
                        <h1>备忘单<a class='headerlink' href='#section-3' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="zh-cheatsheets-linux" heading-number="3.1"><h1 id="zh-cheatsheets-linux-linux">Linux 速查表</h1>
<h2 id="zh-cheatsheets-linux-_1">概览</h2>
<p>在 Linux 操作系统中工作的基本概念是<strong>文件</strong>和<strong>目录</strong>（文件夹），它们在一个<strong>环境</strong>中以树状结构组织。</p>
<p>一旦你登录到 Linux 系统，你就在一个<strong>shell</strong>中工作，在这里你可以通过执行系统上安装的命令来操作文件和目录。Bash shell 是一个常见且流行的 shell，通常可以在 Linux 系统上找到。</p>
<h2 id="zh-cheatsheets-linux-bash">Bash</h2>
<h3 id="zh-cheatsheets-linux-_2">目录导航</h3>
<ul>
<li>进入一个绝对目录：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/dir1/dir2
</code></pre></div>
<ul>
<li>进入一个相对目录：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>./somedir
</code></pre></div>
<ul>
<li>上移一级目录：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<ul>
<li>上移两级目录：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../..
</code></pre></div>
<ul>
<li>移动到你的“主”目录：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>-
</code></pre></div>
<h3 id="zh-cheatsheets-linux-_3">文件管理</h3>
<ul>
<li>列出当前目录中的文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>ls
</code></pre></div>
<ul>
<li>详细列出当前目录中的文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l
</code></pre></div>
<ul>
<li>列出文件系统的根目录：</li>
</ul>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>/
</code></pre></div>
<ul>
<li>创建一个空文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>foo.txt
</code></pre></div>
<ul>
<li>使用 <code>echo</code> 命令创建一个文件：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;hi there&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>查看文件内容：</li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>复制文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>file1<span class="w"> </span>file2
</code></pre></div>
<ul>
<li>通配符：操作文件模式：</li>
</ul>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>fil*<span class="w">  </span><span class="c1"># 匹配 file1 和 file2</span>
</code></pre></div>
<ul>
<li>将两个文件合并为一个新文件 <code>newfile</code>：</li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>file1<span class="w"> </span>file2<span class="w"> </span>&gt;<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>将另一个文件追加到 <code>newfile</code> 中</li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>file3<span class="w"> </span>&gt;&gt;<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>删除文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>删除所有具有相同文件扩展名的文件：</li>
</ul>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>*.dat
</code></pre></div>
<ul>
<li>创建一个目录</li>
</ul>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>dir1
</code></pre></div>
<h3 id="zh-cheatsheets-linux-_4">用管道连接命令</h3>
<p>管道允许用户使用管道 <code>|</code> 符号将一个命令的输出发送到另一个命令：</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;hi&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/hi/bye/&#39;</span>
</code></pre></div>
<ul>
<li>使用 grep 过滤命令输出：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;id,title&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1,birds&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;2,fish&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;3,cats&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt

cat<span class="w"> </span>test-file.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>fish
</code></pre></div>
<ul>
<li>忽略大小写：</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-i<span class="w"> </span>FISH<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>计数匹配行：</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-c<span class="w"> </span>fish<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>返回不包含关键词的输出：</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-v<span class="w"> </span>birds<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>计算 <code>test-file.txt</code> 中的行数：</li>
</ul>
<div class="highlight"><pre><span></span><code>wc<span class="w"> </span>-l<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>逐屏显示输出：</li>
</ul>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>test-file.txt
</code></pre></div>
<p>...带有控制：</p>
<ul>
<li>逐行向下滚动：<em>enter</em></li>
<li>跳到下一页：<em>space bar</em></li>
<li>
<p>回到上一页：<em>b</em></p>
</li>
<li>
<p>显示文件的前3行：</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>head<span class="w"> </span>-3<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>显示文件的最后2行：</li>
</ul>
<div class="highlight"><pre><span></span><code>tail<span class="w"> </span>-2<span class="w"> </span>test-file.txt
</code></pre></div></section><section class="print-page" id="zh-cheatsheets-docker" heading-number="3.2"><h1 id="zh-cheatsheets-docker-docker">Docker 速查表</h1>
<h2 id="zh-cheatsheets-docker-_1">概述</h2>
<p>Docker 允许以隔离的方式创建虚拟环境，支持计算资源的虚拟化。Docker 背后的基本概念是容器化，
其中软件可以作为服务运行，例如与其他软件容器互动。</p>
<p>典型的 Docker 工作流程包括创建和构建<strong>镜像</strong>，然后将其作为活动的<strong>容器</strong>运行。</p>
<p>Docker 用于使用预构建的镜像运行组成 wis2box 的服务套件。</p>
<h3 id="zh-cheatsheets-docker-_2">镜像管理</h3>
<ul>
<li>列出可用的镜像</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>image<span class="w"> </span>ls
</code></pre></div>
<ul>
<li>更新镜像：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>my-image:latest
</code></pre></div>
<ul>
<li>删除镜像：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rmi<span class="w"> </span>my-image:local
</code></pre></div>
<h3 id="zh-cheatsheets-docker-_3">卷管理</h3>
<ul>
<li>列出所有创建的卷：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>ls
</code></pre></div>
<ul>
<li>显示卷的详细信息：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>inspect<span class="w"> </span>my-volume
</code></pre></div>
<ul>
<li>删除卷：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>rm<span class="w"> </span>my-volume
</code></pre></div>
<ul>
<li>删除所有未使用的卷：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>prune
</code></pre></div>
<h3 id="zh-cheatsheets-docker-_4">容器管理</h3>
<ul>
<li>显示当前运行的容器列表：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div>
<ul>
<li>列出所有容器：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps<span class="w"> </span>-a
</code></pre></div>
<ul>
<li>进入运行中容器的交互式终端：</li>
</ul>
<div class="admonition 提示">
<p class="admonition-title">提示</p>
<p>使用 <code>docker ps</code> 在下面的命令中使用容器 id</p>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>my-container<span class="w"> </span>/bin/bash
</code></pre></div>
<ul>
<li>删除容器</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rm<span class="w"> </span>my-container
</code></pre></div>
<ul>
<li>删除正在运行的容器：</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>my-container
</code></pre></div></section><section class="print-page" id="zh-cheatsheets-wis2box" heading-number="3.3"><h1 id="zh-cheatsheets-wis2box-wis2">WIS2 盒装版速查表</h1>
<h2 id="zh-cheatsheets-wis2box-_1">概览</h2>
<p>wis2box 通过一系列 Docker Compose 命令运行。<code>wis2box-ctl.py</code> 命令是一个工具
（用 Python 编写），用于轻松运行 Docker Compose 命令。</p>
<h2 id="zh-cheatsheets-wis2box-wis2box">wis2box 命令要点</h2>
<h3 id="zh-cheatsheets-wis2box-_2">启动与停止</h3>
<ul>
<li>启动 wis2box：</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
</code></pre></div>
<ul>
<li>停止 wis2box：</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>stop
</code></pre></div>
<ul>
<li>验证所有 wis2box 容器是否在运行：</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<ul>
<li>登录到一个 wis2box 容器（默认为 <em>wis2box-management</em>）：</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<ul>
<li>登录到特定的 wis2box 容器：</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
</code></pre></div></section></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>csv2bufr 模板<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="zh-csv2bufr-templates-aws-template" heading-number="4.1"><h1 id="zh-csv2bufr-templates-aws-template-gbon-csv2bufr">针对每小时报告 GBON 数据的自动气象站的 csv2bufr 模板</h1>
<p><strong>AWS 模板</strong> 使用标准化的 CSV 格式来从自动气象站获取数据，以支持 GBON 报告要求。此映射模板将 CSV 数据转换为 BUFR 序列 301150，307096。</p>
<p>该格式适用于报告最少数量的参数的自动气象站，包括压力、气温和湿度、风速和风向以及每小时的降水量。</p>
<h2 id="zh-csv2bufr-templates-aws-template-csv">CSV 列和描述</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Column</th>
<th style="text-align: left;">Units</th>
<th style="text-align: left;">Data type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">wsi_series</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS identifier series</td>
</tr>
<tr>
<td style="text-align: left;">wsi_issuer</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS issuer of identifier</td>
</tr>
<tr>
<td style="text-align: left;">wsi_issue_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS issue number</td>
</tr>
<tr>
<td style="text-align: left;">wsi_local</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Character</td>
<td style="text-align: left;">WIGOS local identifier</td>
</tr>
<tr>
<td style="text-align: left;">wmo_block_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WMO block number</td>
</tr>
<tr>
<td style="text-align: left;">wmo_station_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WMO station number</td>
</tr>
<tr>
<td style="text-align: left;">station_type</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Type of observing station, encoding using code table 0 02 001 (set to 0, automatic)</td>
</tr>
<tr>
<td style="text-align: left;">year</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Year (UTC), the time of observation (based on the actual time the barometer is read)</td>
</tr>
<tr>
<td style="text-align: left;">month</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Month (UTC), the time of observation (based on the actual time the barometer is read)</td>
</tr>
<tr>
<td style="text-align: left;">day</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Day (UTC), the time of observation (based on the actual time the barometer is read)</td>
</tr>
<tr>
<td style="text-align: left;">hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Hour (UTC), the time of observation (based on the actual time the barometer is read)</td>
</tr>
<tr>
<td style="text-align: left;">minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Minute (UTC), the time of observation (based on the actual time the barometer is read)</td>
</tr>
<tr>
<td style="text-align: left;">latitude</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Latitude of the station (to 5 decimal places)</td>
</tr>
<tr>
<td style="text-align: left;">longitude</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Longitude of the station (to 5 decimal places)</td>
</tr>
<tr>
<td style="text-align: left;">station_height_above_msl</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of the station ground above mean sea level (to 1 decimal place)</td>
</tr>
<tr>
<td style="text-align: left;">barometer_height_above_msl</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of the barometer above mean sea level (to 1 decimal place), typically height of station ground plus the height of the sensor above local ground</td>
</tr>
<tr>
<td style="text-align: left;">station_pressure</td>
<td style="text-align: left;">Pa</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Pressure observed at the station level to the nearest 10 pascals</td>
</tr>
<tr>
<td style="text-align: left;">msl_pressure</td>
<td style="text-align: left;">Pa</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Pressure reduced to mean sea level to the nearest 10 pascals</td>
</tr>
<tr>
<td style="text-align: left;">geopotential_height</td>
<td style="text-align: left;">gpm</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Geoptential height expressed in geopotential meters (gpm) to 0 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">thermometer_height</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of thermometer or temperature sensor above the local ground to 2 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">air_temperature</td>
<td style="text-align: left;">Kelvin</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Instantaneous air temperature to 2 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">dewpoint_temperature</td>
<td style="text-align: left;">Kelvin</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Instantaneous dewpoint temperature to 2 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">relative_humidity</td>
<td style="text-align: left;">%</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Instantaneous relative humidity to zero decimal places</td>
</tr>
<tr>
<td style="text-align: left;">method_of_ground_state_measurement</td>
<td style="text-align: left;">code table</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Method of observing the state of the ground, encoded using code table 0 02 176</td>
</tr>
<tr>
<td style="text-align: left;">ground_state</td>
<td style="text-align: left;">code table</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">State of the ground encoded using code table 0 20 062</td>
</tr>
<tr>
<td style="text-align: left;">method_of_snow_depth_measurement</td>
<td style="text-align: left;">code table</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Method of observing the snow depth encoded using code table 0 02 177</td>
</tr>
<tr>
<td style="text-align: left;">snow_depth</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Snow depth at time of observation to 2 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_intensity</td>
<td style="text-align: left;">kg m-2 h-1</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Intensity of precipitation at time of observation to 5 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">anemometer_height</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of the anemometer above local ground  to 2 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">time_period_of_wind</td>
<td style="text-align: left;">minutes</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Defines the time period over which the wind speed and direction have been averaged. Set to -10 to indicate a measurement period over the preceeding 10 minutes.</td>
</tr>
<tr>
<td style="text-align: left;">wind_direction</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Wind direction (at anemometer height) averaged from the caterisan components over the indicated time period, 0 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">wind_speed</td>
<td style="text-align: left;">ms-1</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Wind speed (at anemometer height) averaged from the cartesian components over the indicated time period, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_direction_10_minutes</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Highest 3 second average over the preceeding 10 minutes, 0 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_speed_10_minutes</td>
<td style="text-align: left;">ms-1</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Highest 3 second average over the preceeding 10 minutes, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_direction_1_hour</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Highest 3 second average over the preceeding hour, 0 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_speed_1_hour</td>
<td style="text-align: left;">ms-1</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Highest 3 second average over the preceeding hour, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_direction_3_hours</td>
<td style="text-align: left;">degrees</td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Highest 3 second average over the preceeding 3 hours, 0 decimal places</td>
</tr>
<tr>
<td style="text-align: left;">maximum_wind_gust_speed_3_hours</td>
<td style="text-align: left;">ms-1</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Highest 3 second average over the preceeding 3 hours, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">rain_sensor_height</td>
<td style="text-align: left;">meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of the rain gauge above local ground to 2 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">total_precipitation_1_hour</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total precipitation over the past hour, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">total_precipitation_3_hours</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total precipitation over the past 3 hours, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">total_precipitation_6_hours</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total precipitation over the past 6 hours, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">total_precipitation_12_hours</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total precipitation over the past 12 hours, 1 decimal place</td>
</tr>
<tr>
<td style="text-align: left;">total_precipitation_24_hours</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total precipitation over the past 24 hours, 1 decimal place</td>
</tr>
</tbody>
</table>
<h2 id="zh-csv2bufr-templates-aws-template-_1">示例</h2>
<p>符合 AWS 模板的示例 CSV 文件：<a href="/sample-data/aws-example.csv">aws-example.csv</a>。</p></section><section class="print-page" id="zh-csv2bufr-templates-daycli-template" heading-number="4.2"><h1 id="zh-csv2bufr-templates-daycli-template-csv2bufr-daycli">日常气候数据的 csv2bufr 模板（DAYCLI）</h1>
<p><strong>DAYCLI</strong> 模板提供了一个标准化的 CSV 格式，用于将日常气候数据转换为 BUFR 序列 307075。</p>
<p>该格式旨在与气候数据管理系统一起使用，以支持在 WIS2 上发布数据，以满足日常气候观测的报告要求。</p>
<p>此模板映射了每日观测数据：</p>
<ul>
<li>24小时内的最低、最高和平均温度</li>
<li>24小时内的总降水量</li>
<li>观测时的总积雪深度</li>
<li>24小时内的新雪深度</li>
</ul>
<p>此模板需要额外的元数据，相对于简化的 AWS-模板：计算平均温度的方法；传感器和站点高度；暴露和测量质量分类。</p>
<div class="admonition 注意">
<p class="admonition-title">关于 DAYCLI 模板</p>
<p>请注意，DAYCLI BUFR 序列将在 2025 年更新，以包括额外信息和修订的质量控制标志。包含在 wis2box 中的 DAYCLI 模板将更新以反映这些变化。WMO 将通知何时更新 wis2box-软件以包含新的 DAYCLI 模板，以便用户相应更新其系统。</p>
</div>
<h2 id="zh-csv2bufr-templates-daycli-template-csv">CSV 列和描述</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Column</th>
<th style="text-align: left;">Units</th>
<th style="text-align: left;">Data Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">wsi_series</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS Identifier series, set to 0 for stations</td>
</tr>
<tr>
<td style="text-align: left;">wsi_issuer</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS Identifier issue, ISO 3 digit (number) country code or 20000 series</td>
</tr>
<tr>
<td style="text-align: left;">wsi_issue_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WIGOS Identifier issue number</td>
</tr>
<tr>
<td style="text-align: left;">wsi_local</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Character</td>
<td style="text-align: left;">WIGOS Identifier local identifier, alphanumeric, max 16 characters</td>
</tr>
<tr>
<td style="text-align: left;">wmo_block_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WMO block number for station 0 - 99</td>
</tr>
<tr>
<td style="text-align: left;">wmo_station_number</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">WMO station number 0 - 999</td>
</tr>
<tr>
<td style="text-align: left;">latitude</td>
<td style="text-align: left;">Degrees</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Latitude of the station (to 5 decimal places)</td>
</tr>
<tr>
<td style="text-align: left;">longitude</td>
<td style="text-align: left;">Degrees</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Longitude of the station (to 5 decimal places)</td>
</tr>
<tr>
<td style="text-align: left;">station_height_above_msl</td>
<td style="text-align: left;">Meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of the station ground above mean sea level (to 1 decimal place)</td>
</tr>
<tr>
<td style="text-align: left;">temperature_siting_classification</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Combined sensor siting and measurement quality classification (temperature). See references for siting classification</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_siting_classification</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Combined sensor siting and measurement quality classification (precipitation). See references for siting classification</td>
</tr>
<tr>
<td style="text-align: left;">averaging_method</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Method used to calculate daily average temperature</td>
</tr>
<tr>
<td style="text-align: left;">year</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Year (UTC) of nominal reporting day</td>
</tr>
<tr>
<td style="text-align: left;">month</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Month (UTC) of nominal reporting day</td>
</tr>
<tr>
<td style="text-align: left;">day</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Day (UTC) of month for nominal reporting day</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for precipitation, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the precipitation is measured</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the precipitation is measured</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the precipitation is measured</td>
</tr>
<tr>
<td style="text-align: left;">precipitation</td>
<td style="text-align: left;">kg m-2</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total accumulated precipitation over indicated 24 hour period (kg m-3, equivalent to mm)</td>
</tr>
<tr>
<td style="text-align: left;">precipitation_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for total accumulated precipitation</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for fresh snow depth, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the fresh snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the fresh snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the fresh snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_depth</td>
<td style="text-align: left;">Meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Fresh snow depth over indicated 24 hour period (m, 2 d.p.)</td>
</tr>
<tr>
<td style="text-align: left;">fresh_snow_depth_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for the fresh snow depth</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for total snow depth, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the total snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the total snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the total snow depth is measured</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_depth</td>
<td style="text-align: left;">Meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Total snow depth over indicated 24 hour period (m, 2 d.p.)</td>
</tr>
<tr>
<td style="text-align: left;">total_snow_depth_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for the total snow depth</td>
</tr>
<tr>
<td style="text-align: left;">thermometer_height</td>
<td style="text-align: left;">Meters</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Height of thermometer above local ground level (m)</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for maximum temperature, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the maximum temmperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the maximum temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the maximum temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature</td>
<td style="text-align: left;">Kelvin</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Maximum temperature over indicated 24 hour period (K, 2 d.p.)</td>
</tr>
<tr>
<td style="text-align: left;">maximum_temperature_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for the maximum temperature</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for minimum temperature, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the minimum temmperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the minimum temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the minimum temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature</td>
<td style="text-align: left;">Kelvin</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Minimum temperature over indicated 24 hour period (K, 2 d.p.)</td>
</tr>
<tr>
<td style="text-align: left;">minimum_temperature_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for the minimum temperature</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature_day_offset</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Start of reporting period for average temperature, offset in days relative to nominal reporting day (-1 or 0)</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature_hour</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning hour (UTC) over which the average temmperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature_minute</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning minute (UTC) over which the average temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature_second</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Beginning second (UTC) over which the average temperature is measured</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature</td>
<td style="text-align: left;">Kelvin</td>
<td style="text-align: left;">Decimal</td>
<td style="text-align: left;">Average temperature over indicated 24 hour period (K, 2 d.p.)</td>
</tr>
<tr>
<td style="text-align: left;">average_temperature_flag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Integer</td>
<td style="text-align: left;">Quality control flag for the average temperature</td>
</tr>
</tbody>
</table>
<h2 id="zh-csv2bufr-templates-daycli-template-_1">平均方法</h2>
<table>
<thead>
<tr>
<th style="text-align: right;">Integer</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Average of minimum and maximum temperatures</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Average of 8 tri-hourly observations</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Average of 24 hourly observations</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Weighted average of three observations</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Weighted average of three observations, as well as the minimum and maximum values</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">AWS complete integration from minute data</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Average of 4 six-hourly observations</td>
</tr>
</tbody>
</table>
<h2 id="zh-csv2bufr-templates-daycli-template-_2">质量标志</h2>
<table>
<thead>
<tr>
<th style="text-align: right;">Integer</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Data checked and declared good</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Data checked and declared suspect</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Data checked and declared aggregated</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Data checked and declared out of instrument range</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Data checked and declared aggregated and out of instrument range</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Parameter is not measured at the station</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Daily value not provided</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Data unchecked</td>
</tr>
</tbody>
</table>
<h2 id="zh-csv2bufr-templates-daycli-template-_3">定位分类参考</h2>
<p><a href="https://library.wmo.int/idviewer/35625/839">“温度定位分类”参考资料</a>。</p>
<p><a href="https://library.wmo.int/idviewer/35625/840">“降水定位分类”参考资料</a>。</p>
<h2 id="zh-csv2bufr-templates-daycli-template-_4">示例</h2>
<p>符合 DAYCLI 模板的示例 CSV 文件：<a href="/sample-data/daycli-example.csv">daycli-example.csv</a>。</p></section></section></div><style>.print-site-enumerate-headings #zh > h1:before { content: '1 ' }

                .print-site-enumerate-headings #zh h2 { counter-reset: counter-zh-3 1; counter-increment: counter-zh-2 }
                .print-site-enumerate-headings #zh h2:before { content: '1.' counter(counter-zh-2) ' ' }
            
                .print-site-enumerate-headings #zh h3 { counter-reset: ; counter-increment: counter-zh-3 }
                .print-site-enumerate-headings #zh h3:before { content: '1.' counter(counter-zh-2) '.' counter(counter-zh-3) ' ' }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #zh-practical-sessions-connecting-to-wis2-over-mqtt > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #zh-practical-sessions-connecting-to-wis2-over-mqtt h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-connecting-to-wis2-over-mqtt-3 }
                .print-site-enumerate-headings #zh-practical-sessions-connecting-to-wis2-over-mqtt h3:before { content: '2.1.' counter(counter-zh-practical-sessions-connecting-to-wis2-over-mqtt-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-accessing-your-student-vm > h1:before { content: '2.2 ' }

                .print-site-enumerate-headings #zh-practical-sessions-accessing-your-student-vm h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-accessing-your-student-vm-3 }
                .print-site-enumerate-headings #zh-practical-sessions-accessing-your-student-vm h3:before { content: '2.2.' counter(counter-zh-practical-sessions-accessing-your-student-vm-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-initializing-wis2box > h1:before { content: '2.3 ' }

                .print-site-enumerate-headings #zh-practical-sessions-initializing-wis2box h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-initializing-wis2box-3 }
                .print-site-enumerate-headings #zh-practical-sessions-initializing-wis2box h3:before { content: '2.3.' counter(counter-zh-practical-sessions-initializing-wis2box-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-configuring-wis2box-datasets > h1:before { content: '2.4 ' }

                .print-site-enumerate-headings #zh-practical-sessions-configuring-wis2box-datasets h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-configuring-wis2box-datasets-3 }
                .print-site-enumerate-headings #zh-practical-sessions-configuring-wis2box-datasets h3:before { content: '2.4.' counter(counter-zh-practical-sessions-configuring-wis2box-datasets-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-configuring-station-metadata > h1:before { content: '2.5 ' }

                .print-site-enumerate-headings #zh-practical-sessions-configuring-station-metadata h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-configuring-station-metadata-3 }
                .print-site-enumerate-headings #zh-practical-sessions-configuring-station-metadata h3:before { content: '2.5.' counter(counter-zh-practical-sessions-configuring-station-metadata-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-monitoring-wis2-notifications > h1:before { content: '2.6 ' }

                .print-site-enumerate-headings #zh-practical-sessions-monitoring-wis2-notifications h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-monitoring-wis2-notifications-3 }
                .print-site-enumerate-headings #zh-practical-sessions-monitoring-wis2-notifications h3:before { content: '2.6.' counter(counter-zh-practical-sessions-monitoring-wis2-notifications-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr > h1:before { content: '2.7 ' }

                .print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-converting-synop-data-to-bufr-3 }
                .print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr h3:before { content: '2.7.' counter(counter-zh-practical-sessions-converting-synop-data-to-bufr-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr-form > h1:before { content: '2.8 ' }

                .print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr-form h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-converting-synop-data-to-bufr-form-3 }
                .print-site-enumerate-headings #zh-practical-sessions-converting-synop-data-to-bufr-form h3:before { content: '2.8.' counter(counter-zh-practical-sessions-converting-synop-data-to-bufr-form-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-converting-csv-data-to-bufr > h1:before { content: '2.9 ' }

                .print-site-enumerate-headings #zh-practical-sessions-converting-csv-data-to-bufr h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-converting-csv-data-to-bufr-3 }
                .print-site-enumerate-headings #zh-practical-sessions-converting-csv-data-to-bufr h3:before { content: '2.9.' counter(counter-zh-practical-sessions-converting-csv-data-to-bufr-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-automating-data-ingestion > h1:before { content: '2.10 ' }

                .print-site-enumerate-headings #zh-practical-sessions-automating-data-ingestion h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-automating-data-ingestion-3 }
                .print-site-enumerate-headings #zh-practical-sessions-automating-data-ingestion h3:before { content: '2.10.' counter(counter-zh-practical-sessions-automating-data-ingestion-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-adding-gts-headers-to-wis2-notifications > h1:before { content: '2.11 ' }

                .print-site-enumerate-headings #zh-practical-sessions-adding-gts-headers-to-wis2-notifications h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-adding-gts-headers-to-wis2-notifications-3 }
                .print-site-enumerate-headings #zh-practical-sessions-adding-gts-headers-to-wis2-notifications h3:before { content: '2.11.' counter(counter-zh-practical-sessions-adding-gts-headers-to-wis2-notifications-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-datasets-with-access-control > h1:before { content: '2.12 ' }

                .print-site-enumerate-headings #zh-practical-sessions-datasets-with-access-control h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-datasets-with-access-control-3 }
                .print-site-enumerate-headings #zh-practical-sessions-datasets-with-access-control h3:before { content: '2.12.' counter(counter-zh-practical-sessions-datasets-with-access-control-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-downloading-data-from-wis2 > h1:before { content: '2.13 ' }

                .print-site-enumerate-headings #zh-practical-sessions-downloading-data-from-wis2 h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-downloading-data-from-wis2-3 }
                .print-site-enumerate-headings #zh-practical-sessions-downloading-data-from-wis2 h3:before { content: '2.13.' counter(counter-zh-practical-sessions-downloading-data-from-wis2-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-discovering-datasets-from-wis2-gdc > h1:before { content: '2.14 ' }

                .print-site-enumerate-headings #zh-practical-sessions-discovering-datasets-from-wis2-gdc h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-discovering-datasets-from-wis2-gdc-3 }
                .print-site-enumerate-headings #zh-practical-sessions-discovering-datasets-from-wis2-gdc h3:before { content: '2.14.' counter(counter-zh-practical-sessions-discovering-datasets-from-wis2-gdc-3) ' ' }
            
.print-site-enumerate-headings #zh-practical-sessions-querying-data-using-the-wis2box-api > h1:before { content: '2.15 ' }

                .print-site-enumerate-headings #zh-practical-sessions-querying-data-using-the-wis2box-api h3 { counter-reset: ; counter-increment: counter-zh-practical-sessions-querying-data-using-the-wis2box-api-3 }
                .print-site-enumerate-headings #zh-practical-sessions-querying-data-using-the-wis2box-api h3:before { content: '2.15.' counter(counter-zh-practical-sessions-querying-data-using-the-wis2box-api-3) ' ' }
            
.print-site-enumerate-headings #section-3 > h1:before { content: '3 ' }
.print-site-enumerate-headings #zh-cheatsheets-linux > h1:before { content: '3.1 ' }

                .print-site-enumerate-headings #zh-cheatsheets-linux h3 { counter-reset: ; counter-increment: counter-zh-cheatsheets-linux-3 }
                .print-site-enumerate-headings #zh-cheatsheets-linux h3:before { content: '3.1.' counter(counter-zh-cheatsheets-linux-3) ' ' }
            
.print-site-enumerate-headings #zh-cheatsheets-docker > h1:before { content: '3.2 ' }

                .print-site-enumerate-headings #zh-cheatsheets-docker h3 { counter-reset: ; counter-increment: counter-zh-cheatsheets-docker-3 }
                .print-site-enumerate-headings #zh-cheatsheets-docker h3:before { content: '3.2.' counter(counter-zh-cheatsheets-docker-3) ' ' }
            
.print-site-enumerate-headings #zh-cheatsheets-wis2box > h1:before { content: '3.3 ' }

                .print-site-enumerate-headings #zh-cheatsheets-wis2box h3 { counter-reset: ; counter-increment: counter-zh-cheatsheets-wis2box-3 }
                .print-site-enumerate-headings #zh-cheatsheets-wis2box h3:before { content: '3.3.' counter(counter-zh-cheatsheets-wis2box-3) ' ' }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #zh-csv2bufr-templates-aws-template > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #zh-csv2bufr-templates-aws-template h3 { counter-reset: ; counter-increment: counter-zh-csv2bufr-templates-aws-template-3 }
                .print-site-enumerate-headings #zh-csv2bufr-templates-aws-template h3:before { content: '4.1.' counter(counter-zh-csv2bufr-templates-aws-template-3) ' ' }
            
.print-site-enumerate-headings #zh-csv2bufr-templates-daycli-template > h1:before { content: '4.2 ' }

                .print-site-enumerate-headings #zh-csv2bufr-templates-daycli-template h3 { counter-reset: ; counter-increment: counter-zh-csv2bufr-templates-daycli-template-3 }
                .print-site-enumerate-headings #zh-csv2bufr-templates-daycli-template h3:before { content: '4.2.' counter(counter-zh-csv2bufr-templates-daycli-template-3) ' ' }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/wis2docs/", "features": ["navigation.indexes", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>